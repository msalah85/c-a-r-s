function Point(n,t){this.x=n;this.y=t}function __wpTranslateOffset(n,t,i,r,u){while(typeof i!="undefined"&&i!=null&&i!=r){n+=i.offsetLeft;t+=i.offsetTop;var f=i.tagName;f!="TABLE"&&f!="BODY"&&(n+=i.clientLeft,t+=i.clientTop);u&&f!="BODY"&&(n-=i.scrollLeft,t-=i.scrollTop);i=i.offsetParent}return new Point(n,t)}function __wpGetPageEventLocation(n,t){return(typeof n=="undefined"||n==null)&&(n=window.event),__wpTranslateOffset(n.offsetX,n.offsetY,n.srcElement,null,t)}function __wpClearSelection(){document.selection.empty()}function WebPart(n,t,i,r,u){this.webPartElement=n;this.allowZoneChange=u;this.zone=i;this.zoneIndex=r;this.title=typeof t!="undefined"&&t!=null?t.innerText:"";n.__webPart=this;typeof t!="undefined"&&t!=null&&(t.style.cursor="move",t.attachEvent("onmousedown",WebPart_OnMouseDown),n.attachEvent("ondragstart",WebPart_OnDragStart),n.attachEvent("ondrag",WebPart_OnDrag),n.attachEvent("ondragend",WebPart_OnDragEnd));this.UpdatePosition=WebPart_UpdatePosition;this.Dispose=WebPart_Dispose}function WebPart_Dispose(){this.webPartElement.__webPart=null}function WebPart_OnMouseDown(){var t=window.event,n=WebPart_GetParentWebPartElement(t.srcElement);if(typeof n!="undefined"&&n!=null){document.selection.empty();try{__wpm.draggedWebPart=n;__wpm.DragDrop()}catch(i){__wpm.draggedWebPart=n;window.setTimeout("__wpm.DragDrop()",0)}t.returnValue=!1;t.cancelBubble=!0}}function WebPart_OnDragStart(){var n=window.event,t=n.srcElement,i;if(typeof t.__webPart=="undefined"||t.__webPart==null){n.returnValue=!1;n.cancelBubble=!0;return}i=n.dataTransfer;i.effectAllowed=__wpm.InitiateWebPartDragDrop(t)}function WebPart_OnDrag(){__wpm.ContinueWebPartDragDrop()}function WebPart_OnDragEnd(){__wpm.CompleteWebPartDragDrop()}function WebPart_GetParentWebPartElement(n){for(var t=n;typeof t.__webPart=="undefined"||t.__webPart==null;)if(t=t.parentElement,typeof t=="undefined"||t==null)break;return t}function WebPart_UpdatePosition(){var n=__wpTranslateOffset(0,0,this.webPartElement,null,!1);this.middleX=n.x+this.webPartElement.offsetWidth/2;this.middleY=n.y+this.webPartElement.offsetHeight/2}function Zone(n,t,i,r,u,f){var o=null,e,s;for(webPartTableContainer=n.rows.length==1?n.rows[0].cells[0]:n.rows[1].cells[0],e=0;e<webPartTableContainer.childNodes.length;e++)if(s=webPartTableContainer.childNodes[e],s.tagName=="TABLE"){o=s;break}if(this.zoneElement=n,this.zoneIndex=t,this.webParts=[],this.uniqueID=i,this.isVertical=r,this.allowLayoutChange=u,this.allowDrop=!1,this.webPartTable=o,this.highlightColor=f,this.savedBorderColor=o!=null?o.style.borderColor:null,this.dropCueElements=[],o!=null)if(r)for(e=0;e<o.rows.length;e+=2)this.dropCueElements[e/2]=o.rows[e].cells[0].childNodes[0];else for(e=0;e<o.rows[0].cells.length;e+=2)this.dropCueElements[e/2]=o.rows[0].cells[e].childNodes[0];this.AddWebPart=Zone_AddWebPart;this.GetWebPartIndex=Zone_GetWebPartIndex;this.ToggleDropCues=Zone_ToggleDropCues;this.UpdatePosition=Zone_UpdatePosition;this.Dispose=Zone_Dispose;o.__zone=this;o.attachEvent("ondragenter",Zone_OnDragEnter);o.attachEvent("ondrop",Zone_OnDrop)}function Zone_Dispose(){for(var n=0;n<this.webParts.length;n++)this.webParts[n].Dispose();this.webPartTable.__zone=null}function Zone_OnDragEnter(){var t=__wpm.ProcessWebPartDragEnter(),n=window.event;t&&(n.returnValue=!1,n.cancelBubble=!0)}function Zone_OnDragOver(){var t=__wpm.ProcessWebPartDragOver(),n=window.event;t&&(n.returnValue=!1,n.cancelBubble=!0)}function Zone_OnDrop(){var t=__wpm.ProcessWebPartDrop(),n=window.event;t&&(n.returnValue=!1,n.cancelBubble=!0)}function Zone_GetParentZoneElement(n){for(var t=n;typeof t.__zone=="undefined"||t.__zone==null;)if(t=t.parentElement,typeof t=="undefined"||t==null)break;return t}function Zone_AddWebPart(n,t,i){var r=null,u=this.webParts.length;return r=this.allowLayoutChange&&__wpm.IsDragDropEnabled()?new WebPart(n,t,this,u,i):new WebPart(n,null,this,u,i),this.webParts[u]=r,r}function Zone_ToggleDropCues(n,t,i){var r,f,e,u,o;(i==!1&&(this.webPartTable.style.borderColor=n?this.highlightColor:this.savedBorderColor),t!=-1)&&(r=this.dropCueElements[t],r&&r.style&&(r.style.height!="100%"||r.webPartZoneHorizontalCueResized||(f=r.parentElement.clientHeight,e=f-10,r.style.height=e+"px",u=r.getElementsByTagName("DIV")[0],u&&u.style&&(u.style.height=r.style.height,o=r.parentElement.clientHeight-f,o&&(r.style.height=e-o+"px",u.style.height=r.style.height)),r.webPartZoneHorizontalCueResized=!0),r.style.visibility=n?"visible":"hidden"))}function Zone_GetWebPartIndex(n){var i=n.x,r=n.y,t,u;if(i<this.webPartTableLeft||i>this.webPartTableRight||r<this.webPartTableTop||r>this.webPartTableBottom)return-1;var o=this.isVertical,f=this.webParts,e=f.length;for(t=0;t<e;t++)if(u=f[t],o){if(r<u.middleY)return t}else if(i<u.middleX)return t;return e}function Zone_UpdatePosition(){var n=__wpTranslateOffset(0,0,this.webPartTable,null,!1),t;for(this.webPartTableLeft=n.x,this.webPartTableTop=n.y,this.webPartTableRight=this.webPartTable!=null?n.x+this.webPartTable.offsetWidth:n.x,this.webPartTableBottom=this.webPartTable!=null?n.y+this.webPartTable.offsetHeight:n.y,t=0;t<this.webParts.length;t++)this.webParts[t].UpdatePosition()}function WebPartDragState(n,t){this.webPartElement=n;this.dropZoneElement=null;this.dropIndex=-1;this.effect=t;this.dropped=!1}function WebPartMenu(n,t,i){this.menuLabelElement=n;this.menuDropDownElement=t;this.menuElement=i;this.menuLabelElement.__menu=this;this.menuLabelElement.attachEvent("onclick",WebPartMenu_OnClick);this.menuLabelElement.attachEvent("onkeypress",WebPartMenu_OnKeyPress);this.menuLabelElement.attachEvent("onmouseenter",WebPartMenu_OnMouseEnter);this.menuLabelElement.attachEvent("onmouseleave",WebPartMenu_OnMouseLeave);typeof this.menuDropDownElement!="undefined"&&this.menuDropDownElement!=null&&(this.menuDropDownElement.__menu=this);this.menuItemStyle="";this.menuItemHoverStyle="";this.popup=null;this.hoverClassName="";this.hoverColor="";this.oldColor=this.menuLabelElement.style.color;this.oldTextDecoration=this.menuLabelElement.style.textDecoration;this.oldClassName=this.menuLabelElement.className;this.Show=WebPartMenu_Show;this.Hide=WebPartMenu_Hide;this.Hover=WebPartMenu_Hover;this.Unhover=WebPartMenu_Unhover;this.Dispose=WebPartMenu_Dispose;var r=this;this.disposeDelegate=function(){r.Dispose()};window.attachEvent("onunload",this.disposeDelegate)}function WebPartMenu_Dispose(){this.menuLabelElement.__menu=null;this.menuDropDownElement.__menu=null;window.detachEvent("onunload",this.disposeDelegate)}function WebPartMenu_Show(){var r,n;typeof __wpm.menu!="undefined"&&__wpm.menu!=null&&__wpm.menu.Hide();var u="<html><head><style>a.menuItem, a.menuItem:Link { display: block; padding: 1px; text-decoration: none; "+this.itemStyle+" }a.menuItem:Hover { "+this.itemHoverStyle+' }<\/style><body scroll="no" style="border: none; margin: 0; padding: 0;" ondragstart="window.event.returnValue=false;" onclick="popup.hide()">'+this.menuElement.innerHTML+"<\/body><\/html>",t=16,i=16;this.popup=window.createPopup();__wpm.menu=this;r=this.popup.document;r.write(u);this.popup.show(0,0,t,i);n=r.body;t=n.scrollWidth;i=n.scrollHeight;t<this.menuLabelElement.offsetWidth&&(t=this.menuLabelElement.offsetWidth+16);this.menuElement.innerHTML.indexOf("progid:DXImageTransform.Microsoft.Shadow")!=-1&&(n.style.paddingRight="4px");n.__wpm=__wpm;n.__wpmDeleteWarning=__wpmDeleteWarning;n.__wpmCloseProviderWarning=__wpmCloseProviderWarning;n.popup=this.popup;this.popup.hide();this.popup.show(0,this.menuLabelElement.offsetHeight,t,i,this.menuLabelElement)}function WebPartMenu_Hide(){__wpm.menu==this&&(__wpm.menu=null,typeof this.popup!="undefined"&&this.popup!=null&&(this.popup.hide(),this.popup=null))}function WebPartMenu_Hover(){this.labelHoverClassName!=""&&(this.menuLabelElement.className=this.menuLabelElement.className+" "+this.labelHoverClassName);this.labelHoverColor!=""&&(this.menuLabelElement.style.color=this.labelHoverColor)}function WebPartMenu_Unhover(){this.labelHoverClassName!=""&&(this.menuLabelElement.style.textDecoration=this.oldTextDecoration,this.menuLabelElement.className=this.oldClassName);this.labelHoverColor!=""&&(this.menuLabelElement.style.color=this.oldColor)}function WebPartMenu_OnClick(){var n=window.event.srcElement.__menu;typeof n!="undefined"&&n!=null&&(window.event.returnValue=!1,window.event.cancelBubble=!0,n.Show())}function WebPartMenu_OnKeyPress(){if(window.event.keyCode==13){var n=window.event.srcElement.__menu;typeof n!="undefined"&&n!=null&&(window.event.returnValue=!1,window.event.cancelBubble=!0,n.Show())}}function WebPartMenu_OnMouseEnter(){var n=window.event.srcElement.__menu;typeof n!="undefined"&&n!=null&&n.Hover()}function WebPartMenu_OnMouseLeave(){var n=window.event.srcElement.__menu;typeof n!="undefined"&&n!=null&&n.Unhover()}function WebPartManager(){this.overlayContainerElement=null;this.zones=[];this.dragState=null;this.menu=null;this.draggedWebPart=null;this.AddZone=WebPartManager_AddZone;this.IsDragDropEnabled=WebPartManager_IsDragDropEnabled;this.DragDrop=WebPartManager_DragDrop;this.InitiateWebPartDragDrop=WebPartManager_InitiateWebPartDragDrop;this.CompleteWebPartDragDrop=WebPartManager_CompleteWebPartDragDrop;this.ContinueWebPartDragDrop=WebPartManager_ContinueWebPartDragDrop;this.ProcessWebPartDragEnter=WebPartManager_ProcessWebPartDragEnter;this.ProcessWebPartDragOver=WebPartManager_ProcessWebPartDragOver;this.ProcessWebPartDrop=WebPartManager_ProcessWebPartDrop;this.ShowHelp=WebPartManager_ShowHelp;this.ExportWebPart=WebPartManager_ExportWebPart;this.Execute=WebPartManager_Execute;this.SubmitPage=WebPartManager_SubmitPage;this.UpdatePositions=WebPartManager_UpdatePositions;window.attachEvent("onunload",WebPartManager_Dispose)}function WebPartManager_Dispose(){for(var n=0;n<__wpm.zones.length;n++)__wpm.zones[n].Dispose();window.detachEvent("onunload",WebPartManager_Dispose)}function WebPartManager_AddZone(n,t,i,r,u){var f=this.zones.length,e=new Zone(n,f,t,i,r,u);return this.zones[f]=e,e}function WebPartManager_IsDragDropEnabled(){return typeof this.overlayContainerElement!="undefined"&&this.overlayContainerElement!=null}function WebPartManager_DragDrop(){if(typeof this.draggedWebPart!="undefined"&&this.draggedWebPart!=null){var n=this.draggedWebPart;this.draggedWebPart=null;n.dragDrop();window.setTimeout("__wpClearSelection()",0)}}function WebPartManager_InitiateWebPartDragDrop(n){var f=n.__webPart,r,t,i,u;if(this.UpdatePositions(),this.dragState=new WebPartDragState(n,"move"),r=__wpGetPageEventLocation(window.event,!0),t=this.overlayContainerElement,t.style.left=r.x-n.offsetWidth/2,t.style.top=r.y+4+(n.clientTop?n.clientTop:0),t.style.display="block",t.style.width=n.offsetWidth,t.style.height=n.offsetHeight,t.appendChild(n.cloneNode(!0)),f.allowZoneChange==!1)f.zone.allowDrop=!0;else for(i=0;i<__wpm.zones.length;i++)u=__wpm.zones[i],u.allowLayoutChange&&(u.allowDrop=!0);return document.body.attachEvent("ondragover",Zone_OnDragOver),"move"}function WebPartManager_CompleteWebPartDragDrop(){var n=this.dragState,t,r,i,u,f;for(this.dragState=null,typeof n.dropZoneElement!="undefined"&&n.dropZoneElement!=null&&n.dropZoneElement.__zone.ToggleDropCues(!1,n.dropIndex,!1),document.body.detachEvent("ondragover",Zone_OnDragOver),t=0;t<__wpm.zones.length;t++)__wpm.zones[t].allowDrop=!1;this.overlayContainerElement.removeChild(this.overlayContainerElement.firstChild);this.overlayContainerElement.style.display="none";typeof n!="undefined"&&n!=null&&n.dropped==!0&&(r=n.webPartElement.__webPart.zone,i=n.webPartElement.__webPart.zoneIndex,(r!=n.dropZoneElement.__zone||i!=n.dropIndex&&i!=n.dropIndex-1)&&(u=n.dropZoneElement.__zone.uniqueID,f="Drag:"+n.webPartElement.id+":"+n.dropIndex,this.SubmitPage(u,f)))}function WebPartManager_ContinueWebPartDragDrop(){var n=this.dragState,t,i;typeof n!="undefined"&&n!=null&&(t=this.overlayContainerElement.style,i=__wpGetPageEventLocation(window.event,!0),t.left=i.x-n.webPartElement.offsetWidth/2,t.top=i.y+4+(n.webPartElement.clientTop?n.webPartElement.clientTop:0))}function WebPartManager_Execute(n){this.menu&&this.menu.Hide();var t=new Function(n);return t()!=!1}function WebPartManager_ProcessWebPartDragEnter(){var n=__wpm.dragState,r,t,i;return typeof n!="undefined"&&n!=null?(r=window.event,t=Zone_GetParentZoneElement(r.srcElement),(typeof t.__zone=="undefined"||t.__zone==null||t.__zone.allowDrop==!1)&&(t=null),i=-1,typeof t!="undefined"&&t!=null&&(i=t.__zone.GetWebPartIndex(__wpGetPageEventLocation(r,!1)),i==-1&&(t=null)),n.dropZoneElement!=t?(typeof n.dropZoneElement!="undefined"&&n.dropZoneElement!=null&&n.dropZoneElement.__zone.ToggleDropCues(!1,n.dropIndex,!1),n.dropZoneElement=t,n.dropIndex=i,typeof t!="undefined"&&t!=null&&t.__zone.ToggleDropCues(!0,i,!1)):n.dropIndex!=i&&(n.dropIndex!=-1&&n.dropZoneElement.__zone.ToggleDropCues(!1,n.dropIndex,!1),n.dropIndex=i,typeof t!="undefined"&&t!=null&&t.__zone.ToggleDropCues(!0,i,!1)),typeof n.dropZoneElement!="undefined"&&n.dropZoneElement!=null&&(r.dataTransfer.effectAllowed=n.effect),!0):!1}function WebPartManager_ProcessWebPartDragOver(){var n=__wpm.dragState,r=window.event,u=!1,t,f,i;return typeof n!="undefined"&&n!=null&&typeof n.dropZoneElement!="undefined"&&n.dropZoneElement!=null&&(t=Zone_GetParentZoneElement(r.srcElement),typeof t!="undefined"&&t!=null&&t.__zone.allowDrop==!1&&(t=null),(typeof t=="undefined"||t==null)&&typeof n.dropZoneElement!="undefined"&&n.dropZoneElement!=null?(n.dropZoneElement.__zone.ToggleDropCues(!1,__wpm.dragState.dropIndex,!1),n.dropZoneElement=null,n.dropIndex=-1):typeof t!="undefined"&&t!=null&&(f=__wpGetPageEventLocation(r,!1),i=t.__zone.GetWebPartIndex(f),i==-1&&(t=null),n.dropZoneElement!=t?((n.dropIndex!=-1||typeof t=="undefined"||t==null)&&n.dropZoneElement.__zone.ToggleDropCues(!1,__wpm.dragState.dropIndex,!1),n.dropZoneElement=t):n.dropZoneElement.__zone.ToggleDropCues(!1,n.dropIndex,!0),n.dropIndex=i,typeof t!="undefined"&&t!=null&&t.__zone.ToggleDropCues(!0,i,!1)),u=!0),(typeof n=="undefined"||n==null||typeof n.dropZoneElement=="undefined"||n.dropZoneElement==null)&&(r.dataTransfer.effectAllowed="none"),u}function WebPartManager_ProcessWebPartDrop(){var t=this.dragState,i,n;return typeof t!="undefined"&&t!=null?(i=window.event,n=Zone_GetParentZoneElement(i.srcElement),typeof n!="undefined"&&n!=null&&n.__zone.allowDrop==!1&&(n=null),typeof n!="undefined"&&n!=null&&t.dropZoneElement==n&&(t.dropped=!0),!0):!1}function WebPartManager_ShowHelp(n,t){if(typeof this.menu!="undefined"&&this.menu!=null&&this.menu.Hide(),t==0||t==1)if(t==0)window.showModalDialog(n,null,"edge: Sunken; center: yes; help: no; resizable: yes; status: no");else window.open(n,null,"scrollbars=yes,resizable=yes,status=no,toolbar=no,menubar=no,location=no");else t==2&&(window.location=n)}function WebPartManager_ExportWebPart(n,t,i){return t==!0&&__wpmExportWarning.length>0&&this.personalizationScopeShared!=!0&&confirm(__wpmExportWarning)==!1?!1:(i==!1&&(window.location=n),!0)}function WebPartManager_UpdatePositions(){for(var n=0;n<this.zones.length;n++)this.zones[n].UpdatePosition()}function WebPartManager_SubmitPage(n,t){typeof this.menu!="undefined"&&this.menu!=null&&this.menu.Hide();__doPostBack(n,t)}var __wpm=null;
//# sourceMappingURL=WebParts.min.js.map
