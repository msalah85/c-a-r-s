var PayInvoicePaymentsPrint=function(){var t=function(){n()},i=function(){$(document).on("click","#listItems tbody .add-discount",function(n){n.preventDefault();var t=$(this),i={discVal:t.attr("title"),id:t.attr("data-id"),oldNote:t.attr("data-note")};$("#pay-id").val(i.id);$("#discount-amount").val(i.discVal);$("#msg").val(i.oldNote);$("#disc-modal").modal("show")});$("#save-discount").click(function(n){n.preventDefault();var t={id:$("#pay-id").val(),discVal:$("#discount-amount").val(),notes:$("#msg")},i={actionName:"PayInvoicePayments_SetDiscount",names:["ID","Amount","Reason"],values:[t.id,t.discVal,t.notes.val()]};t.id!=""&&t.discVal!=""&&t.notes.val()!=""?dataService.callAjax("Post",JSON.stringify(i),sUrl+"saveData",r,commonManger.errorException):(t.notes.focus(),commonManger.showMessage("بيانات مطلوبة","يرجي ادخال جميع البيانات المطلوبة *."))})},r=function(t){t=t.d;$(".modal").modal("hide");commonManger.showMessage("تم تنفيذ الإجراء:",t.message);t.Status&&n()},n=function(){dataService.callAjax("Post",JSON.stringify({actionName:"PayInvoicePayments_PendingList"}),sUrl+"GetDataDirect",u,commonManger.errorException)},u=function(n){var s=commonManger.comp2json(n.d),t=s.list,v=s.list1,r=0,h=3.674,c=160.22,u=0,f=0,l,e,o,a;$("#listItems tbody").html("");l=$(t).map(function(n,t){r+=t.FinalAmount*1;h=t.Rate*1;c=t.Convertamount*1;var i=t.FinalAmount*h,e=i>0?i+c:0;return u+=e,f+=(t.VAT||0)*1,"<tr><td>"+(n+1)+"<\/td><td>"+t.AuctionName+"<\/td><td>"+t.BuyerName+"<\/td><td>"+numeral(t.FinalAmount).format("0,0.00")+"<\/td><td>"+numeral(e).format("0,0.00")+'<a href="payinvoicepaymentspendingprint.aspx#disc-modal" class="hidden-print pull-left add-discount" title="'+numeral(t.DiscountAmount).format("0")+'" data-note="'+(t.DiscountNotes?t.DiscountNotes:"")+'" data-id="'+t.PayInvoicePaymentsID+'">'+(t.DiscountAmount*1>0?numeral(t.DiscountAmount).format("0"):"+خصم")+"<\/a><\/td><\/tr>"}).get();e=$(v).map(function(n,t){return t.PayInvoicePaymentsID}).get().join(",");$("#listItems tbody").append(l);$(".total").text(numeral(r).format("0,0.00"));$(".vatTotalAmount").text(numeral(f).format("0,0.00"));o=u*1+f*1;a=' <a href="ReceiptPaymentsAdd.aspx?pamount='+o.toFixed()+"&ids="+e+'" class="btn btn-mini btn-success pull-left hidden-print">انشاء سند صرف <i class="icon-double-angle-left"><\/i><\/a>';r>0&&($(".totalPaymentTotalDhs").text(numeral(u).format("0,0.00")),$(".totalDhs").text(numeral(o).format("0,0")),e.length>0&&$(".totalDhs").append(a));t&&t[0]&&t[0].UserFullName&&$("#userName").text(t[0].UserFullName);i()};return{Init:t}}();