var CarShopExpenses=function(){var n=0,t=0,u=function(){var r=commonManger.getUrlVars(),i=decodeURIComponent(r.id);t=r.out?r.out:0;i!=""&&i!="undefined"&&i!=null?(n=i,$("#CarIDNo").val(n),$("#CarID").val(n)):(n=0,$("#CarIDNo").val(0),$("#CarID").val(0));console.log(t);t*1>0&&$("#OutOfRequired").val(t);s();h();f()},f=function(){$(".printcar").on("click",function(n){n.preventDefault();window.open("CarShopExpensesPrint.aspx?id="+$("#CarIDNo").val(),"_self")});$("#UnitPrice,#UnitsCount").on("keyup",function(){$("#TotalPrice").val(parseInt($("#UnitPrice").val())*parseInt($("#UnitsCount").val()))});$("a#divAddEdit").on("click",function(){$("#CarShopExpenseID").val("0");$("#CarIDNo").val(n);$("#CarID").val(n);commonManger.ResetControls("aspnetForm");commonManger.showPopUpDialog("تعديل مصروف الشحن ","save","addModal")});$("#SaveAll").click(function(n){n.preventDefault();var t=commonManger.applyValidation();t&&commonManger.saveData("addModal","aspnetForm",e,o,"CarShopExpenses_save","1",i)});$.fn.afterLoadDatawithdata=function(n){var t=n.OutOfRequired==!0?1:0;$("#OutOfRequired").val(t)}},e=function(n){n.Status&&r()},o=function(){},s=function(){DTO={actionName:"CarShopExpenses_Properties",value:n};dataService.callAjax("Post",JSON.stringify(DTO),sUrl+"GetData",function(n){var i=commonManger.comp2json(n.d),r=i.list,t=i.list1;t&&($("#model").val(t.model),t.ClientID&&$("#full_name,.client-Acc").html('<a href="ClientCars.aspx?id='+t.ClientID+'">'+(t.full_name&&t.full_name!=""?t.full_name:t.SaleClientName)+"<\/a>"))},commonManger.errorException)},i=function(){},r=function(){$("#listItems").DataTable().draw()},h=function(){var t=$("#listItems").DataTable({bServerSide:!0,bDestroy:!0,oTableTools:{aButtons:[]},sAjaxSource:"CarShopExpenses.aspx/GetCarShippExpenses?id="+n,fnServerData:function(n,t,i){dataService.callAjax("GET",t,n,function(n){i(n.d)},commonManger.errorException)},iDisplayLength:50,aoColumns:[{mDataProp:"ExpenseSubject",bSortable:!0},{mDataProp:"UnitPrice",bSortable:!0},{mDataProp:"UnitsCount",bSortable:!0},{mDataProp:"TotalPrice",bSortable:!0},{mDataProp:"ExpenseDetails",bSortable:!0},{bSortable:!1,mData:function(){return'<button class="btn btn-minier btn-info edit" data-rel="tooltip" data-placement="top" data-original-title="تعديل"><i class="icon-edit"><\/i><\/button> <button class="btn btn-minier btn-danger remove" data-rel="tooltip" data-placement="top" data-original-title="حــذف"><i class="icon-remove"><\/i><\/button>'}}]});$("#listItems tbody").delegate("tr button","click",function(n){var i,u,f,e,o;n.preventDefault();i=$(this);u=i.closest("tr");u!=null&&(i.hasClass("edit")?(e="تعديل مصروف الشحن ",o="save",f=t.row(u).data(),commonManger.ResetControls("aspnetForm"),commonManger.getDataForUpdate(f,"aspnetForm"),commonManger.showPopUpDialog(e,o,"addModal")):i.hasClass("remove")&&DeleteConfirmation(function(){f=t.row(u).data();var n={actionName:"CarShopExpenses_Delete",names:["ExpenseID"],values:[f.CarShopExpenseID]},i=function(n){console.log(n);r()};dataService.callAjax("Post",JSON.stringify(n),sUrl+"SaveData",i,commonManger.errorException)}))})};return{Init:u,aftersave:i}}();