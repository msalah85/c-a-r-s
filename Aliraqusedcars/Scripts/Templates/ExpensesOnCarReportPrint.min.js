var pageManager=function(){var n=null,t=null,i=null,r=null,u=null,f=null,e=null,o=function(){c();$("#btnSearchAll").click(function(o){o.preventDefault();n=$("#Buyer").val();t=$("#ChassisN").val();i=commonManger.dateFormat($("#From").val());r=commonManger.dateFormat($("#To").val());u=$("#Auction").val();e=$("#DistinationID").val();f=$("#Client").val();h()});$(".getTotalCosts").click(function(n){n.preventDefault();s();$(".sum-total-all").html("يرجي الانتظار..")})},s=function(){var n=function(n){var t=commonManger.comp2json(n.d);t&&t.list&&$(".sum-total-all").html("").html("<span>"+numeral(t.list.AllSoldCarsCosts).format("0,0")+"<\/span> - <span>عدد السيارات: "+numeral(t.list.SoldCarsCount).format("0,0")+"<\/span> - <span>وقت التحديث: "+moment(t.list.AddDate).format("(DD/MM/YYYY hh:mm A)")+"<\/span>")};dataService.callAjax("Post",JSON.stringify({actionName:"ExpensesOnCarReportTotalCosts"}),sUrl+"GetDataDirect",n,commonManger.errorException)},h=function(){$("#listItems").DataTable().draw()},c=function(){var o=$("#listItems").DataTable({sDom:"<'row-fluid tbl-head-options'<'span6'l><'span6 lft-pane'BT>r>t<'row-fluid'<'span6'i><'span6'p>>",buttons:[{extend:"csv",text:"تصدير إكسيل"},{extend:"copy",text:"نسـخ"},{text:"طباعة",action:function(){$(".dataTables_length,.form-horizontal").closest("div.row-fluid").addClass("hidden-print");window.print()}}],responsive:!0,bServerSide:!0,retrieve:!1,bDestroy:!0,sAjaxSource:"rpt/ExpensesOnCarReportPrint.aspx/LoadData",fnServerParams:function(o){o.push({name:"buyer",value:n},{name:"Client",value:f},{name:"auction",value:u},{name:"chassis",value:t},{name:"from",value:i},{name:"to",value:r},{name:"DistinationID",value:e})},fnServerData:function(n,t,i){var r=function(n){var f=commonManger.comp2json(n.d),u=f.list,r=f.list1,e;r=r?$.map(r,function(n){return n}):[0];e={sEcho:t.sEcho?t.sEcho:0,iTotalRecords:r[0],iTotalDisplayRecords:r[0],aaData:$.isArray(u)?u:$.makeArray(u)};i(e)};dataService.callAjax("GET",t,n,r,commonManger.errorException)},fnRowCallback:function(n,t){t.PayInvTypeID==3&&$(n).addClass("car-relist")},fnFooterCallback:function(n,t){for(var r,u=0,f=0,e=0,i=0;i<t.length;i++)u+=t[i].TotalOnCar*1,r=t[i].SalePrice*1+t[i].CarExtras*1,e+=r,f+=r-t[i].TotalOnCar*1;$(n).find("th:eq(1)").html(numeral(u).format("0,0"));$(n).find("th:eq(2)").html(numeral(e).format("0,0"));$(n).find("th:eq(3)").html(numeral(f).format("0,0"))},pageLength:25,aaSorting:[],aoColumns:[{mDataProp:"CarID",bSortable:!0},{mDataProp:"InvoiceDate",bSortable:!0,mData:function(n){return commonManger.formatJSONDateCal(n.InvoiceDate,"dd/MM/yyyy")}},{mDataProp:"TypeNameAr",bSortable:!1,mData:function(n){return'<a title="تفاصيل السيارة" href="CarDetailsPrint.aspx?id='+n.CarID+'">'+n.MakerNameAr+" - "+n.TypeNameAr+" - "+n.Year+'<\/a><p title="الشاصي">'+n.ChassisNo+"<\/p>"}},{bSortable:!1,mData:function(n){return numeral(n.PayPayments*1+n.PayPrice*1).format("0,0")}},{mData:"ExchangeFeeOnCar",bSortable:!1,mData:function(n){return numeral(n.ExchangeFeeOnCar).format("0,0.00")}},{mData:"Towing",bSortable:!1,mData:function(n){return numeral(n.Towing).format("0,0.00")}},{mData:"LoadingShippingCosts",bSortable:!1,mData:function(n){return numeral(n.LoadingShippingCosts).format("0,0.00")}},{mData:"ShippingExtra",bSortable:!1,mData:function(n){return numeral(n.ShippingExtra*1).format("0,0.00")}},{mData:"CustomExpensesOnCar",bSortable:!1,mData:function(n){return numeral(n.CustomExpensesOnCar).format("0,0.00")}},{mData:"CustomOnCar",bSortable:!1,mData:function(n){return numeral(n.CustomOnCar).format("0,0.00")}},{mData:"DiscountAmount",bSortable:!1,mData:function(n){return numeral(n.DiscountAmount).format("0,0.00")}},{mData:"ShippExpensesCost",bSortable:!1,mData:function(n){return numeral(n.ShippExpensesCost).format("0,0.00")}},{mData:"ShopExpensesCost",bSortable:!1,mData:function(n){return numeral(n.ShopExpensesCost).format("0,0.00")}},{mData:"AuctionCommCost",bSortable:!1,mData:function(n){return numeral(n.AuctionCommCost).format("0,0.00")}},{bSortable:!1,mData:function(n){return numeral(n.TotalOnCar).format("0,0.00")}},{bSortable:!1,mData:function(n){return'<span title="سعر البيع: '+numeral(n.SalePrice).format("0,0.00")+" + الزيادة: "+numeral(n.CarExtras).format("0,0.00")+'">'+numeral(n.SalePrice*1+n.CarExtras*1).format("0,0.00")+"<\/span>"}},{bSortable:!1,mData:function(n){return numeral(n.SalePrice*1+n.CarExtras*1-n.TotalOnCar*1).format("0,0.00")}}]})};return{Init:o}}();