var PayInvoicePaymentsPrint=function(){var n="",t="",u="",i=[],f=function(){var t=commonManger.getUrlVars(),n=decodeURIComponent(t.id);n!=""&&n!="undefined"&&n!=null?(u=n,r(n),$("#PayInvoicePaymentsIDH").text(n),$("#PayInvoicePaymentsID").text(n),$("a[data-pk]").attr("data-pk",n)):(r(""),$("#PayInvoicePaymentsID").val(value="0"));t.review>0&&($(".new").removeClass("hidden"),$(".title").text("مراجعة حوالة فواتير الشراء"))},r=function(n){var t={actionName:"PayInvoicePayments_PropertiesPrint",value:n};dataService.callAjax("Post",JSON.stringify(t),mainServiceUrl+"GetData",function(n){var i=JSON.parse(n.d),t=$.grep(i,function(n){return n.tbl_name=="150"}),u=$.grep(i,function(n){return n.tbl_name!="150"}),r;$.each(t[0],function(n,t){$("#"+n).text(t);n==="CheckNo"&&t!==""?$(".new").removeClass("hidden"):n==="PaymentsDates"&&t!==""&&$("#"+n).text(function(){return commonManger.dateFormat(t,"M/D/YYYY","DD/MM/YYYY")});($("#"+n).hasClass("editable")||$("#"+n).hasClass("editable-no"))&&t&&t!=null&&$("#"+n).removeClass("editable editable-click editable-no").removeAttr("href id data-table data-id data-name class data-pk data-type").closest("tr").removeClass("new hidden")});r=t[0].TotalAmount*1-t[0].DiscountAmount*1;$(".net-amount").text(r);t[0].CheckNo*1>0&&$("#CheckNo").attr("href",function(){return"ReceiptPaymentsPrint.aspx?id="+$(this).text()});o(u);$(".money").text(function(){return numeral($(this).text()).format("0,0.00")})},commonManger.errorException)},e=function(){$("a.editable").editable({emptytext:"لا يوجــد",source:i,value:$(this).data("currentVal"),validate:function(n){if($.trim(n)==="")return"مطلوب."},url:function(n){return n.table=$(this).data("table"),n.id=$(this).data("id"),$.ajax({type:"POST",url:sUrl+"InlineEdit",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",dataType:"json",async:!0,cache:!1,timeout:1e4,success:function(){commonManger.showMessage("تم الحفظ:","تم حفظ البيان بنجاح.")},error:function(){commonManger.showMessage("خطأ:","لقد حدث خطأ فى تنفيذ الإجراء.")}})}})},o=function(r){t=$("#listItems2").DataTable({sDom:"<'row'>t<'row'>",bDestroy:!0,bLengthChange:!1,bFilter:!1,searching:!1,paging:!1});var u=["Model","LotNo","Storge","LatPayment"],f=[],h=0,c=0;$.each(r,function(n,r){var n,e;if(r.tbl_name===161){for(n=0;n<u.length;n++)f.push(r[u[n]]),n==2?c+=r[u[n]]*1:n==3&&(h+=r[u[n]]*1);e=t.row.add(f).draw();f=[];e.nodes().to$().children("td:eq(2)").addClass("red");e.nodes().to$().children("td:eq(3)").addClass("red")}else r.tbl_name==0&&i.push({value:r.ID,text:r.Name})});$(".storTotal").text(numeral(c).format("0,0.00"));$(".lateTotal").text(numeral(h).format("0,0.00"));n=$("#listItems").DataTable({sDom:"<'row'>t<'row'>",bDestroy:!0,bLengthChange:!1,bFilter:!1,searching:!1,paging:!1});var o=["CarID","Model","LotNo","full_name","PayPrice"],s=[],l=0;$.each(r,function(t,i){if(i.tbl_name===160){for(var t=0;t<o.length;t++)s.push(i[o[t]]),t>3&&(l+=i[o[t]]*1);n.row.add(s).draw().nodes().to$().children("td:eq(4)").addClass("green").text(function(){return numeral($(this).text()).format("0,0.00")});s=[]}});$(".carsTotal").text(numeral(l).format("0,0.00"));e();applyEditableControlNo()};return{Init:f}}();