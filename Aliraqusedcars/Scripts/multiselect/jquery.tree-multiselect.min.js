(function(n){"use strict";function o(t){return n.extend({},{allowBatchSelection:!0,collapsible:!0,freeze:!1,hideSidePanel:!1,onChange:null,onlyBatchSelection:!1,sectionDelimiter:"/",showSectionOnSelected:!0,sortable:!1,startCollapsed:!1},t)}function s(r,u,f){function o(i,r){for(var f,h,c,o,l,u=e,s=0;s<i.length;++s){if(f=i[s],u[f]||(u[f]=[]),u=u[f],s==i.length-1){u.push(r);break}for(f=i[s+1],h=null,c=0;c<u.length;++c)if(o=u[c],o.constructor!=t&&n.isPlainObject(o)&&o[f]&&typeof o[f]!="undefined"){h=o;break}h?u=h:(l=u.push({}),u=u[l-1])}}var e={};r.find("> option").each(function(){var i=n(this),r=i.attr("data-section").split(f.sectionDelimiter),u=i.val(),e=i.text(),s=i.attr("data-description"),h=i.attr("data-index"),c=new t(u,e,s,h);o(r,c)});i(u,e)}function i(r,u){function s(t,i){var r=document.createElement("div"),u;return r.className="section",u=document.createElement("div"),u.className="title",u.innerHTML=i,n(r).append(u),t.append(r),r}function h(t,i){var f=i.text,u=i.value,e=i.description,o=i.index,r=document.createElement("div");return r.className="item",n(r).text(f||u).attr({"data-value":u,"data-description":e,"data-index":o}),t.append(r),r}var f,e,o;if(u.constructor==t)h(r,u);else if(n.isArray(u))for(f=0;f<u.length;++f)i(r,u[f]);else for(e in u)u.hasOwnProperty(e)&&(o=n(s(r,e)),i(o,u[e]))}function h(t){var i=n("<span class='description'>?<\/span>"),r=t.find("div.item[data-description!=''][data-description]");i.prependTo(r);n("div.item > span.description").unbind().mouseenter(function(){var i=n(this).parent(),r=i.attr("data-description"),t=document.createElement("div");t.className="temp-description-popup";t.innerHTML=r;t.style.position="absolute";i.append(t)}).mouseleave(function(){var t=n(this).parent();t.find("div.temp-description-popup").remove()})}function c(t,i){var u=n("<input />",{type:"checkbox",value:""}),r;i.freeze&&u.attr("disabled","disabled");r=null;r=i.onlyBatchSelection?t.find("div.title"):i.allowBatchSelection?t.find("div.title, div.item"):t.find("div.item");u.attr("value",r.attr("data-value"));u.prependTo(r);t.find("input[type=checkbox]").click(function(n){n.stopPropagation()})}function l(t,i){var r=t.val(),u;r&&(u=i.find("div.item").filter(function(){var t=n(this);return r.indexOf(t.attr("data-value"))!==-1}),u.find("> input[type=checkbox]").prop("checked",!0))}function a(t){var i=t.find("div.title > input[type=checkbox]");i.change(function(){var t=n(this),i=t.closest("div.section"),r=i.find("input[type=checkbox]"),u=t.is(":checked");r.prop("checked",u)})}function v(t){var i=t.find("input[type=checkbox]");i.change(function(){var i=n(this),r;i.is(":checked")||(r=i.parentsUntil(t,"div.section"),r.find("> div.title > input[type=checkbox]").prop("checked",!1))})}function y(t){function i(){var i=t.find("div.section");i.each(function(){var i=n(this),r=i.find("div.item"),u=r.filter(function(){var t=n(this).find("> input[type=checkbox]");return!t.is(":checked")}),t;u.length===0&&(t=n(this).find("> div.title > input[type=checkbox]"),t.prop("checked",!0))})}u(t,i)}function p(t){function i(){var i=t.find("div.section");i.each(function(){var t=n(this),i=t.find("div.item"),r=i.filter(function(){var t=n(this);return t.find("> input[type=checkbox]").prop("checked")}).length,u=t.find("> div.title > input[type=checkbox]"),f=r!==0&&r!==i.length;u.prop("indeterminate",f)})}u(t,i)}function w(t,i){var u="-",e="+",f=t.find("div.title"),r=document.createElement("span");r.className="collapse-section";i.startCollapsed?(n(r).text(e),f.siblings().toggle()):n(r).text(u);f.prepend(r);n("span.collapse-section").unbind().click(function(t){var i,r,f;t.stopPropagation();i=n(this);r=i.text();i.text(r==u?e:u);f=i.parent();f.siblings().toggle()});f.click(function(){n(this).find("> span.collapse-section").trigger("click")})}function b(t,i,r,o){function l(t){var u=t.text,f=t.value,e=t.sectionName,r=document.createElement("div");r.className="item";r.innerHTML=u;o.showSectionOnSelected&&n(r).append("<span class='section-name'>"+e+"<\/span>");o.freeze||n(r).prepend("<span class='remove-selected'>×<\/span>");n(r).attr("data-value",f).appendTo(i)}function a(r){var e=[],u;return i.find("div.item").each(function(){e.push(n(this).attr("data-value"))}),u=r.filter(function(n){return e.indexOf(n.value)==-1}),u.forEach(function(n){l(n)}),f(t,i),u}function v(r){var e=[],u,f,o;return r.forEach(function(n){e.push(n.value)}),u=[],i.find("div.item").each(function(t,i){var r=n(i),f=r.attr("data-value");e.indexOf(f)==-1&&(u.push(f),r.remove())}),f=[],o=t.find("div.item"),o.each(function(){var t=n(this);u.indexOf(t.attr("data-value"))!==-1&&f.push(h(t))}),f}function s(){var t=[];i.find("div.item").each(function(){t.push(n(this).attr("data-value"))});r.val(t).change();r.html(r.find("option").sort(function(i,r){var u=t.indexOf(n(i).attr("value")),f=t.indexOf(n(r).attr("value"));return u>f?1:u<f?-1:0}))}function h(i){var u=e(i),f=i.attr("data-value"),s=i.attr("data-index"),r;return i.attr("data-index",undefined),r=n.map(i.parentsUntil(t,"div.section").get().reverse(),function(t){return e(n(t).find("> div.title"))}).join(o.sectionDelimiter),{text:u,value:f,initialIndex:s,sectionName:r}}function y(){var e=t.find("div.item").has("> input[type=checkbox]:checked"),r=[],u,f;if(e.each(function(){var t=n(this);r.push(h(t))}),r.sort(function(n,t){var i=parseInt(n.initialIndex),r=parseInt(t.initialIndex);return i>r?1:i<r?-1:0}),u=a(r),f=v(r),s(),c)c=!1;else if(o.onChange)o.onChange(r,u,f);o.sortable&&!o.freeze&&i.sortable({update:function(){s()}})}var c=!0;u(t,y)}function f(t,i){i.find("span.remove-selected").unbind().click(function(){var r=n(this).parent().attr("data-value"),u=t.find("div.item[data-value='"+r+"']"),i=u.find("> input[type=checkbox]");i.prop("checked",!1);i.change()})}function u(n,t){var i=n.find("input[type=checkbox]");i.change(function(){t()});t()}function e(t){return n(t).clone().children().remove().end().text()}var r,t;n.fn.treeMultiselect=function(t){var i=o(t);return this.each(function(){var u=n(this),e,t,o;u.attr("multiple","").css("display","none");e=new r;e.build(u,i.hideSidePanel);t=n(e.selections);s(u,t,i);h(t,i);c(t,i);l(u,t,i);i.allowBatchSelection&&(a(t,i),v(t,i),y(t,i),p(t,i));i.collapsible&&w(t,i);o=n(e.selected);b(t,o,u,i);f(t,o,i)}),this};r=function(){};r.prototype.build=function(t,i){var r=document.createElement("div"),u,f;r.className="tree-multiselect";n(t).after(r);u=document.createElement("div");u.className="selections";i&&(u.className+=" no-border");n(r).append(u);f=document.createElement("div");f.className="selected";i||n(r).append(f);this.tree=r;this.selections=u;this.selected=f};t=function(n,t,i,r){this.value=n;this.text=t;this.description=i;this.index=r}})(jQuery);
//# sourceMappingURL=jquery.tree-multiselect.min.js.map
