var ClientBuyersManager=function(){var i=function(){e();r()},r=function(){$("#BuyerModal .modal-footer .btn-success").on("click",function(i){var f,e;i.preventDefault();var r={};r.ClientBuyerID=$("#ClientBuyerID").val();r.BuyerID=$("#ddlBuyerID option:selected").val();r.ClientID=$("#ddlClientID option:selected").val();r.Active=$("#cbActive").is(":checked")?!0:!1;r.EndDate=$("#txtToDate").val();f={scParam:r};e=u();e&&commonManger.doWork("BuyerModal","aspnetForm","ClientBuyers.aspx/SaveClientBuyer",f,n,t)})},n=function(n){n=n.d;$("#BuyerModal").modal("hide");commonManger.showMessage("تمت عملية الإضافه بنجاح.",n.Message);n.Status&&$("#listItems").dataTable().fnDraw()},t=function(n,t,i){var u=t+": "+i,r=JSON.parse(n.responseText).Message;$("span[id$=lblError]").html(r).closest("div").removeClass("hide").removeClass("alert-success").addClass("alert-danger")},u=function(){var n=!1;return $("select[id$=ddlBuyerID] option:selected").val()!=""&&$("select[id$=ddlClientID] option:selected").val()!=""&&(n=!0),n},f=function(){for(var t=[],n,r=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),i=0;i<r.length;i++)n=r[i].split("="),t.push(n[0]),t[n[0]]=n[1];return t},e=function(){var r=f().client,i=$("#listItems").dataTable({oTableTools:{aButtons:["copy","xls","print"]},bServerSide:!0,responsive:!0,responsive:!0,sAjaxSource:"ClientBuyers.aspx/GetBuyers?clientID="+r,fnServerData:function(n,t,i){dataService.callAjax("GET",t,n,function(n){i(n.d)},commonManger.errorException)},iDisplayLength:50,aoColumns:[{mDataProp:"full_name",bSortable:!0},{mDataProp:"BuyerName",bSortable:!0},{mDataProp:"AuctionName",bSortable:!0},{mDataProp:"Active",bSortable:!1,sWidth:"50",mData:function(n){return n.Active?'<span class="label label-success">مفعل<\/span>':'<span class="label label-important">غير مفعل<\/span>'}},{mDataProp:"StartDate",bSortable:!0},{mDataProp:"EndDate",bSortable:!0}]});commonManger.searchData(i);$("#listItems tbody").delegate("tr button","click",function(r){var f,e,u;if(r.preventDefault(),f=$(this),e=f.closest("tr").index(),e!=null)if(f.hasClass("edit"))u=i.fnGetData(e),$("#aspnetForm")[0].reset(),$("#ClientBuyerID").val(u.ClientBuyerID),$("#txtToDate").val(u.EndDate),u.EndDate!=""?$("#txtToDate").removeAttr("disabled"):$("#txtToDate").val("").attr("disabled","disabled"),$("input[id$=cbActive]").attr("checked",$(u.Active).html()=="مفعل"?!0:!1),$("select[id$=ddlBuyerID]").val(f.parent().find("input[id$=aID_"+u.BuyerID+"]").val()),$("select[id$=ddlClientID]").val(f.parent().find("input[id$=cID_"+u.ClientID+"]").val()),commonManger.showPopUpDialog("تعديل رقم المــزاد للعميل","edit","BuyerModal");else f.hasClass("remove")&&DeleteConfirmation(function(){u=i.fnGetData(e);var r=u.ClientID+","+u.BuyerID;commonManger.deleteData("anyThing",n,t,"ClientBuyers","ClientID,BuyerID",r)})})};return{Init:i}}();ClientBuyersManager.Init();