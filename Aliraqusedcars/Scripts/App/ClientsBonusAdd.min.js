var pageManager=function(){var n=function(){t();i();var n=commonManger.fullRoles();n&&$("#Revised").closest("div.control-group").removeClass("hidden")},t=function(){var n=commonManger.getUrlVars(),t;n&&(n.id&&($(".page-header h1 span").html("تعديل"),u(n.id)),n.cid&&(t=decodeURIComponent(n.cname.split("-").join(" ")),$("#ClientID").select2("data",{id:n.cid,text:t}).closest(".control-group").addClass("hidden"),$("h1:eq(0) small").html(' - <a class="pink" href="clientcars.aspx?id='+n.cid+'">'+t+"<\/a>"),$("#AmountDhs").closest(".control-group").addClass("hidden")))},i=function(){$("input[type=text]").on("focus click",function(){$(this).select()});$("#Amount").on("blur change",function(){var t=$("#PayTypeID input:checked").val(),n=$("#Amount").val();n=$.isNumeric(n)?n*3.667:0;$("#AmountDhs").val(n.toFixed(2))});$("#SaveAll").click(function(n){n.preventDefault();commonManger.disableControl("SaveAll",!0);var t=r();t?commonManger.saveData("masterForm","masterForm",e,"","ClientsBonus_Save","1",f):commonManger.disableControl("SaveAll",!1)})},o=function(n){var i=commonManger.comp2json(n.d),t=i.list;t?($(".message").html('<div class="alert alert-danger span12"><i class="icon-warning-sign red"><\/i> <strong>إيصال مكرر:<\/strong> رقم الايصال الذى تم ادخاله موجود من قبل لسند قبض رقم: <a href="ClientBonusPrint.aspx?id='+t.ReceiptID+'">'+t.ReceiptID+'<\/a><button type="button" class="close" data-dismiss="alert"><i class="icon-remove"><\/i><\/button><\/div>'),commonManger.showMessage("ايصال مكرر","هذا الايصال موجود بالفعل من قبل برقم: "+t.ReceiptID),$("#SaveAll").attr("disabled","disabled")):($("#SaveAll").removeAttr("disabled"),$(".message").html(""))},s=function(){$(".select2").trigger("change")},r=function(){for(var i=!0,t=$("#masterForm :input:not(:hidden).required"),n=0;n<t.length;n++)($(t[n]).val()==""||$(t[n]).val()=="0")&&(i=!1,$(t[n]).focus());return i},u=function(n){var t={actionName:"ClientsBonus_One",value:n},i=function(n){var i=commonManger.comp2json(n.d),t=i.list;t&&($("#Revised").attr("checked",t.Revised==="true"),$.each(t,function(n,t){$("#masterForm #"+n).val(t)}),$("#ClientID").select2("data",{id:t.ClientID,text:t.full_name}),$("#Amount,#AmountDhs").val(function(){return numeral($(this).val()).format("0.0")}))};dataService.callAjax("Post",JSON.stringify(t),sUrl+"GetData",i,commonManger.errorException)},f=function(){},e=function(n){window.location.href="ClientBonusPrint.aspx?id="+n.ID};return{Init:n}}();