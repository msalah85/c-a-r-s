modalDialog="addModal";tableName="ClientExtras";pKey="ClientExtraID";gridId="listItems";gridColumns=[];formName="aspnetForm";var targetdata,clientId=commonManger.getQueryStrs().id,filterNames="ClientID",filterValues=clientId,getClientName=function(){var n=tableName+"_Properties",t={actionName:n,value:clientId};dataService.callAjax("Post",JSON.stringify(t),sUrl+"GetData",function(n){var i=commonManger.comp2json(n.d),t=i.list;t&&$(".client-name").text(t.full_name)},commonManger.errorException)};$.fn.beforeSave=function(){var n=$("#CarID").val(),t=$("#Notes");return!$.isNumeric(n)&&!(n*1>0)?(commonManger.showMessage("بيانات مطلوبة","يرجي اختيار رقم السيارة أولاً."),DefaultGridManager.btnProceessing($('.btn[type="submit"]'),!1),!1):t.val()===""?(DefaultGridManager.btnProceessing($('.btn[type="submit"]'),!1),t.focus(),commonManger.showMessage("بيانات مطلوبة","يرجي اختيار سبب الزيادة أولاً."),!1):!0};getClientName();$("#ClientID").val(clientId);$("#clientLink,.client-name").attr("href","ClientCars.aspx?id="+clientId);$.extend(!0,$.fn.dataTable.defaults,{searching:!1});gridColumns.push({mDataProp:"ClientExtraID",bSortable:!0},{mDataProp:"CarID",bSortable:!0,mData:function(n){return'<a title="تفاصيل السيارة" href="CarDetailsPrint.aspx?id='+n.CarID+'">'+n.CarID+"<\/a>"}},{mDataProp:"AddDate",bSortable:!0,mData:function(n){return commonManger.formatJSONDateCal(n.AddDate,"dd/MM/yyyy")}},{mDataProp:"Notes",bSortable:!1},{mDataProp:"ExtraAmount",bSortable:!1,mData:function(n){return numeral(n.ExtraAmount).format("0,0")}},{bSortable:!1,mData:function(){var n=commonManger.fullRoles();return n?'<button class="btn btn-danger btn-mini remove" title="حذف"><i class="icon-trash"><\/i><\/button>':""}});DefaultGridManager.Init();$("#btnDelete").click(function(n){n.preventDefault();var t={id:$(".removeField").text(),reason:$("#Reason")},i={actionName:tableName+"_Delete",names:["id","reason"],values:[t.id,t.reason.val()]};t.reason.val()!==""?dataService.callAjax("Post",JSON.stringify(i),sUrl+"saveData",function(n){n=n.d;n.Status?commonManger.showMessage("تم الحذف",n.message):commonManger.showMessage("لم يتم الحذف","حدث خطأ اثناء الحذف"+n.message);DefaultGridManager.updateGrid();$(".modal").modal("hide")},commonManger.errorException):(t.reason.focus(),commonManger.showMessage("بيانات مطلوبة","يرجي ادخال سبب الحذف"))});$(".modal").on("hide.bs.modal",function(){$("#Reason").val("");$("#Reason").focus()});