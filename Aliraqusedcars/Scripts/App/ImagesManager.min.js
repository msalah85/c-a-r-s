var imagesManger=imagesManger||{},imagesManger=function(){var n=$("#btnUpload"),e="/photo/UploadPicture.ashx/",o=function(){l();s()},s=function(){n.click(function(i){i.preventDefault();t(n,!1);p()});$("#deleteAll").on("click",function(i){i.preventDefault();confirm("هل أنت متأكد من حذف جميع صور السيارة")&&(t(n,!1),b())});$(document).on("click","a.itemToDelete",function(i){i.preventDefault();var r=$(this);DeleteConfirmation(function(){t(n,!1);var i=r.attr("data-id");w(i)})});$(document).on("click","a.set-main",function(i){i.preventDefault();var r=$(this),u=r.data("id"),f=function(){t(n,!1);nt(u)};c(f)});$(document).on("click","#UpdatePriority",function(i){i.preventDefault();t(n,!1);var r=$(":input[type=number]").map(function(){return $("#carId").val()+","+$(this).data("id")+","+$(this).val()}).get(),u=mainServiceUrl+"UpdateImagesIndexes",f={values:r};dataService.callAjax("Post",JSON.stringify(f),u,function(){t(n,!0);commonManger.showMessage("تم التحديث","تم تحديث ترتيب العرض بنجاح.")},commonManger.errorException)});$(document).on("click","a.ShareCar",function(n){return n.preventDefault(),newwindow=window.open($(this).attr("href"),"Share Car","height=700,width=525"),window.focus&&newwindow.focus(),!1});$(document).on("click","a.show-hide-pic",function(f){f.preventDefault();var o=$(this),e={id:o.data("id"),active:o.data("active")},s=function(r){if(r=r.d,r.Status){var f=e.active===1?"إخفاء الصورة من العرض بالموقع.":"إعادة عرض الصورة بالموقع.";i("success","تم بنجاح:","تم تنفيذ الإجراء بنجاح، "+f);u()}else i("success","خطأ بالإجراء:","لقد حدث خطأ أثناء تنفيذ الإجراء بنجاح.");t(n,!0)},c=function(){t(n,!1);var i={actionName:"PicturesHide_Show",names:["ID","Hide"],values:[e.id,e.active]};dataService.callAjax("Post",JSON.stringify(i),sUrl+"saveData",s,r)};h(c,e.active)});$(document).on("click","#updateOldPics",function(n){n.preventDefault();_url=mainServiceUrl+"UpdateCarImages";data={id:$("#carId").val()};dataService.callAjax("Post",JSON.stringify(data),_url,function(){u();commonManger.showMessage("تم التحديث","تم تحديث ترتيب العرض بنجاح.")},commonManger.errorException);$(this).addClass("hidden")})},h=function(n,t){var i=t===1?"إخفاء الصورة":"إعادة عرض الصورة";if($.isFunction(n))bootbox.confirm("هل أنت متأكد من تنفيذ الإجراء ("+i+") الذى تم اختيارها؟",function(t){t&&n()});else return confirm("هل أنت متأكد من تنفيذ الإجراء ("+i+") الذى تم اختيارها؟")},c=function(n){if($.isFunction(n))bootbox.confirm("هل أنت متأكد من وضع هذه الصورة كصورة رئيسية للسيارة؟",function(t){t&&n()});else return confirm("هل أنت متأكد من وضع هذه الصورة كصورة رئيسية للسيارة؟")},l=function(){var n=commonManger.getUrlVars().id;$("#carId").val(n);$("#divTitle").append(" رقم : "+n);$("#ShareCar").attr("href",$("#ShareCar").attr("href")+n);document.title+="للسيارة رقم: "+n;u()},t=function(n,t){t?n.removeAttr("disabled").text("ارفع الآن"):n.prop("disabled","disabled").text("جارى رفع الصور...")},a=function(){$(".ace-file-input a.remove").click()},i=function(n,t,i){n=n==undefined||n==""?"warning":n;$("#divMessage").html('<div class="alert alert-'+n+' fade in"><a class="close" data-dismiss="alert" href="#">×<\/a> <strong>'+t+"<\/strong>: "+i+"<\/div>");commonManger.showMessage(t,i)},v=function(r){r=r.d!=undefined?r.d:r;r.indexOf("تمت")>-1?(i("success","تم الرفع",r),a(),u()):i("danger","لم يتم الرفع",r);t(n,!0)},r=function(n,t,r){title=t+": "+r;message=JSON.parse(n.responseText).Message;console.log(title+": "+message);i("danger","خطأ بالنظام: "+title,"برجاء الاتصال بادارة النظام: "+message)},y=function(n){n=n.d;var i=$("#divIMagesList"),r=$("#carId").val(),t=$("#hfMainImage").val();i.html("");$(n).each(function(n,u){var f='<li><a target="_blank" href="/public/cars/'+r+"/"+u+'" data-rel="colorbox">                    <img style="width: 150px; height: 150px" src="/public/cars/'+r+"/_thumb/"+u+'" />                    <div class="text">                        <div class="inner">'+(t==u?"صورة رئيسية":"صورة السيارة")+'<\/div>                    <\/div>                <\/a>                    <div class="tools tools-bottom">                        <a href="javascript:void(0);" class="set-main '+(t==u?"hidden":"")+'" data-id="'+u+'" title="'+(t==u?"صورة رئيسية":"")+'"><i class="icon-paper-clip"><\/i><\/a>                        <a class="itemToDelete" href="javascript:void(0);" data-id="'+u+'" title="حذف الصورة"><i class="icon-remove red"><\/i><\/a>                    <\/div>                <\/li>';i.append(f)}).promise().done(function(){})},tt=function(){var n=mainServiceUrl+"ShowCarImages",t={id:$("#carId").val()};dataService.callAjax("Post",JSON.stringify(t),n,y,r)},p=function(){var a=$("#FileUpload2").get(0),f=a.files,s=new FormData,l=$("#carId").val(),h,u,o,c;for(s.append("cid",l),h=!1,u=0;u<f.length;u++)o=f[u],typeof o=="string"?/\.(jpe?g|png|gif|bmp)$/i.test(o)&&(s.append(f[u].name,f[u]),h=!0):(c=$.trim(o.type),(c.length>0&&/^image\/(jpe?g|png|gif|bmp)$/i.test(c)||/\.(jpe?g|png|gif|bmp)$/i.test(o.name))&&(s.append(f[u].name,f[u]),h=!0));h&&l!=""?$.ajax({type:"POST",url:e,data:s,cache:!1,contentType:!1,processData:!1,success:v,error:r}):(i("","اختر الصور","برجاء اختيار صور السيارة أولاً."),t(n,!0))},f=function(r){r=r.d;r=="1"?(i("success","تم الحذف","تمت عملية الحذف بنجاح."),u()):i("danger","خطأ","لم تتم عملية الحذف.");t(n,!0)},w=function(n){var t=$("#carId").val(),i=$("#hfMainImage").val(),u=mainServiceUrl+"DeleteImage",e={id:t,p:n,main:i};dataService.callAjax("Post",JSON.stringify(e),u,f,r)},b=function(){var n=$("#carId").val(),t=mainServiceUrl+"DeleteCarImage",i={id:n};dataService.callAjax("Post",JSON.stringify(i),t,f,r)},k=function(n){var i=commonManger.comp2json(n.d),r=i.list,t=i.list1,u=$("#divIMagesList"),f=$("#carId").val();u.html("");r&&$(r).each(function(n,t){var i='<li><div class="text">'+(t.MainPicture==t.URL?"<span class='red'>صورة رئيسية<\/span>":"<span>ترتيب:<\/span>")+' <input data-id="'+t.ID+'" class="thumb-index" type="number" value="'+t.Priority+'" /><\/div><a target="_blank" class="colorbox" href="/public/cars/'+f+"/"+t.URL+'" data-rel="colorbox">                    <img style="width: 150px; height: 150px" src="/public/cars/'+f+"/_thumb/"+t.URL+'" /><\/a>                    <div class="tools tools-bottom">                        <a href="javascript:void(0);" class="set-main '+(t.MainPicture==t.URL?"hidden":"")+'" data-id="'+t.URL+'" title="'+(t.MainPicture==t.URL?"صورة رئيسية":"ثبتها كصورة رئيسية للسيارة")+'"><i class="icon-paper-clip"><\/i><\/a>                        <a data-id="'+t.ID+'" data-active="'+(t.HidePicID?0:1)+'" href="javascript:void(0);" title="'+(t.HidePicID?"عرض الصورة بالموقع":"إخفاء الصورة من العرض بالموقع")+'" class="show-hide-pic"><i class="icon-eye-'+(t.HidePicID?"close orange":"open green")+'"><\/i><\/a>                        <a class="itemToDelete" href="javascript:void(0);" data-id="'+t.URL+'" title="حذف الصورة"><i class="icon-remove red"><\/i><\/a>                    <\/div>                <\/li>';u.append(i)}).promise().done(function(){var n={reposition:!0,scalePhotos:!0,scrolling:!1,previous:'<i class="icon-arrow-left"><\/i>',next:'<i class="icon-arrow-right"><\/i>',close:"&times;",current:"{current} من {total}",maxWidth:"100%",maxHeight:"100%",onOpen:function(){document.body.style.overflow="hidden"},onClosed:function(){document.body.style.overflow="auto"},onComplete:function(){$.colorbox.resize()},rel:"group1"};$('[data-rel="colorbox"]').colorbox(n);$("#cboxLoadingGraphic").append("<i class='icon-spinner orange'><\/i>")});t&&$(".carInfo").html('<a class="purple" href="CarDetailsPrint.aspx?id='+$("#carId").val()+'">'+t.MakerNameEn+" - "+t.TypeNameEn+" - "+t.Year+' - <span data-rel="tooltip" title="Lot No">'+t.LotNo+'<\/span> - <span data-rel="tooltip" title="شاصي">'+t.ChassisNo+"<\/span><\/a>");d();$("#divIMagesList li").length>0&&$("#updateOldPics").addClass("hidden")},d=function(){$('[data-toggle="tooltip"],[data-rel=tooltip],.ace-tooltip').tooltip()},u=function(){var n=$("#carId").val(),t=sUrl+"GetData",i={actionName:"Images_GetMain",value:n};dataService.callAjax("Post",JSON.stringify(i),t,k,r)},g=function(r,u){r=r.d;r=="1"?($("#hfMainImage").val(u),$("#divIMagesList li a.hidden").removeClass("hidden").attr("title","صورة السيارة").closest("li").find("div.text span").html("ترتيب: ").removeClass("red"),$('#divIMagesList li a[data-id="'+u+'"]').attr("title","صورة رئيسية").addClass("hidden").closest("li").find("div.text span").html("<span class='red'>صورة رئيسية<\/span>"),i("success","تم الاجراء بنجاح:","تم وضع الصورة الرئيسية للسيارة بنجاح.")):i("danger","لم يتم الاجراء:","لم يتم وضع الصورة الرئيسية للسيارة، برجاء إعادة تحميل الصفحة والمحاولة مرة أخري.");t(n,!0)},nt=function(n){var t=$("#carId").val(),i=mainServiceUrl+"SetMainImage",u={id:t,p:n};dataService.callAjax("Post",JSON.stringify(u),i,success=function(t){g(t,n)},r)};return{Init:o}}();imagesManger.Init();
//# sourceMappingURL=ImagesManager.min.js.map
