var ReceiptPayment=ReceiptPayment||{},ReceiptPayment=function(){var n="",t="",i="",r="",u="",e=function(){c();o()},o=function(){$("#SearchAll").on("click",function(e){e.preventDefault();n=$("#ToName").val();t=$("#BankID").val()!=""?$("#BankID").val():"";i=commonManger.dateFormat($("#From").val())!=""?commonManger.dateFormat($("#From").val()):"";r=commonManger.dateFormat($("#To").val())!=""?commonManger.dateFormat($("#To").val()):"";u=$("#ReceiptExpenseTypeID").val()!=""?$("#ReceiptExpenseTypeID").val():"";f()});$("#cancelModal .modal-footer .btn-danger").on("click",function(n){var t,i;if(n.preventDefault(),t=$("#ReceiptID").val(),i=$("#DeleteReason").val(),t&&i!=""){var r=[t,i],u={actionName:"ReceiptPayments_Delete",names:["ReceiptID","DeleteReason"],values:r};dataService.callAjax("Post",JSON.stringify(u),sUrl+"saveData",s,commonManger.errorException)}else commonManger.showMessage("حقول مطلوبة","يرجي ادخال سبب الإلغاء أولاً."),$("#DeleteReason").focus()})},s=function(n){$(".modal").modal("hide");n=n.d;commonManger.showMessage("تم تنفيذ الإجراء بنجاح.",n.message);n.Status&&f()},h=function(){var n=commonManger.fullRoles();return n?'<button class="btn btn-minier btn-danger remove" data-rel="tooltip" data-placement="top" data-original-title="حــذف"><i class="icon-remove"><\/i><\/button> ':""},f=function(){$("#listItems").DataTable().draw()},c=function(){var f=$("#listItems").DataTable({sDom:"<'row-fluid'<'span6'l><'span6 lft-pane'BT>r>t<'row-fluid'<'span6'i><'span6'p>>",buttons:[{extend:"csv",text:"تصدير إكسيل"},{text:"طباعة",action:function(){$(".dataTables_length,.form-horizontal").closest("div.row-fluid").addClass("hidden-print");window.print()}}],bDestroy:!0,bServerSide:!0,responsive:!0,responsive:!0,sAjaxSource:sUrl+"LoadDataTablesXML",fnServerParams:function(f){var e=n+"~"+t+"~"+i+"~"+r+"~"+u;f.push({name:"funName",value:"ReceiptPayments_SelectList"},{name:"names",value:"ToName~BankID~From~To~Type"},{name:"values",value:e})},fnServerData:function(n,t,i){dataService.callAjax("GET",t,n,function(n){commonManger.setData2Grid(n,t.sEcho,i)},commonManger.errorException)},footerCallback:function(){var n=this.api(),t=n.column(6).data().reduce(function(n,t){return numeral().unformat(n)+numeral().unformat(t)},0);$("strong.debit").html(numeral(t).format("0,0"))},aaSorting:[],iDisplayLength:50,aoColumns:[{mDataProp:"ReceiptID",bSortable:!0,type:"number"},{mDataProp:"AddDate",bSortable:!0,mData:function(n){return commonManger.formatJSONDateCal(n.AddDate)}},{mDataProp:"ExpenseTypeName",bSortable:!0},{mDataProp:"ToName",bSortable:!0},{mDataProp:"BankName",bSortable:!0,mData:function(n){return n.BankName?n.BankName:""}},{mDataProp:"CheckNo",bSortable:!0,mData:function(n){return n.CheckNo?n.CheckNo:""}},{mDataProp:"Amount",bSortable:!0,mData:function(n){return numeral(n.Amount).format("0,0")}},{mDataProp:"AmountDhs",bSortable:!0,mData:function(n){return numeral(n.AmountDhs).format("0,0")}},{sClass:"hidden-print",mData:function(n){var t="";return n.Revised==0&&(t='<a class="btn btn-minier btn-info" href="ReceiptPaymentsAdd.aspx?id='+n.ReceiptID+'" title="تعديل"><i class="icon-edit"><\/i><\/a> '+h()),t+'<a href="ReceiptPaymentsPrint.aspx?id='+n.ReceiptID+'" class="btn btn-minier btn-success" data-rel="tooltip" title="طباعة" data-original-title="طباعة"><i class="icon-print"><\/i><\/a>'}}]});$("#listItems tbody").delegate("tr button","click",function(n){var i,r,t,u,e;n.preventDefault();i=$(this);r=i.closest("tr").index();r!=null&&i.hasClass("remove")&&(u="إلغاء إيداع عميل",e="cancelModal",t=f.row(r).data(),$("#ReceiptID").val(t.ReceiptID),$("#AddDate").val(commonManger.formatJSONDateCal(t.AddDate)),$("#Amount").val(t.Amount),commonManger.showPopUpDialog(u,"",e))})};return{Init:e}}();