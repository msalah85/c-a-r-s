var pageManager=pageManager||{},pageManager=function(){var n={},t=null,f=function(){e();h()},e=function(){var i,r;n={modalId:"#addModal",allModalElm:$("#divMyForm input,#divMyForm textarea"),rendDetailsID:$("#RentDetailsID"),addNewBtn:$("a.addition"),saveCheckBtn:$("button.btnAddRow"),SaveAll:$("#SaveAll"),totalAmounts:$("#TotalAmount"),RentID:$("#RentID"),deleteBtn:'<button class="btn btn-minier btn-danger remove" title="حــذف"><i class="icon-remove"><\/i><\/button>',editBtn:'<button class="btn btn-minier btn-info edit" title="تعديل"><i class="icon-edit"><\/i><\/button>',tableRowIndex:$("[name=RowIndex]")};t=$("#listItems").DataTable({sDom:"<'row'>t<'row'>",retrieve:!0,searching:!1,paging:!1,sort:!1,columnDefs:[{targets:[0],visible:!1}]});i=commonManger.getUrlVars();i.id&&(r=decodeURIComponent(i.id),n.RentID.val(r),o(r))},o=function(i){var u={actionName:"Rents_Details",value:i},f=function(i){var u=commonManger.comp2json(i.d),f=u.list,e=u.list1;$.each(f,function(n,t){var i=$("#"+n);i.hasClass("date-picker")?i.val(commonManger.formatJSONDateCal(t,"dd/MM/yyyy")):i.hasClass("money")?i.val(numeral(t).format("0")):i.val(t)});$(e).each(function(i,u){for(var e=commonManger.returnFiledsNames("divMyForm"),f=[],i=0;i<e.length;i++)f.push(u[e[i]]);f[1]=numeral(f[1]).format("0");f[2]=commonManger.formatJSONDateCal(f[2],"dd/MM/yyyy");u.ReceiptID?f.push(""):f.push(n.editBtn+" "+n.deleteBtn);t.row.add(f).draw();r()})};dataService.callAjax("POST",JSON.stringify(u),sUrl+"GetData",f,commonManger.errorException)},u=function(){n.allModalElm.val("");n.rendDetailsID.val(0);n.tableRowIndex.val(-1)},s=function(){var t=!0;return n.allModalElm.each(function(){var n=$(this);n.hasClass("required")&&n.val()===""?(t=!1,n.closest("div.control-group").addClass("error")):n.closest("div.control-group").removeClass("error").addClass("info")}),t},h=function(){n.addNewBtn.click(function(n){n.preventDefault();u();i(!0)});n.saveCheckBtn.click(function(n){n.preventDefault();var t=s();t&&l()});$("#listItems tbody").delegate("tr button.remove","click",function(n){var u,i,f;n.preventDefault();u=$(this);i=u.closest("tr");i&&(f=function(){var n=t.row(i);n.remove().draw();r()},DeleteConfirmation(f))});$("#listItems tbody").delegate("tr button.edit","click",function(r){var e,f,o;r.preventDefault();e=$(this);f=e.closest("tr");f&&(o=t.row(f).data(),u(),n.tableRowIndex.val(f.index()),$("#divMyForm [id]").each(function(n){$(this).val(o[n])}),i(!0))});n.SaveAll.click(function(n){var i,u,f,r;n.preventDefault();i="aspnetForm";u=c(i);u&&(f=commonManger.returnFiledsNamesToSave("divMyForm"),r=[],t.rows().every(function(){var n=this.data(),t;n.pop();n[2]&&(n[2]=commonManger.dateFormat(n[2],"D/M/YYYY","MM/DD/YYYY"));t=n.join(",");r.push(t)}),commonManger.SaveDataMasterDetails("",i,v,"",f,r,"Rents_Save","1"))})},c=function(n){var t=!0;return $("#"+n+" .required").each(function(){$(this).val()===""&&(t=!1)}),t},i=function(t){t?$(n.modalId).modal("show"):$(n.modalId).modal("hide")},l=function(){for(var e,u=[],o=commonManger.returnFiledsNames("divMyForm"),h=$("#RentDetailsID").val()*1,s=n.tableRowIndex.val()*1,f=0;f<o.length;f++)u.push($("#"+o[f]).val());u.push(n.editBtn+" "+n.deleteBtn);s>-1?(e=$("#listItems tbody tr:eq("+s+")"),e&&t.row(e).data(u).draw()):t.row.add(u).draw();commonManger.showMessage("تمت الاضافة:","تم اضافة الشيك بنجاح.");i(!1);a();r()},r=function(){var i=0,r=t.column(1).data().each(function(n){i=i+n*1});n.totalAmounts.val(i);i>0?n.SaveAll.removeClass("hidden"):n.SaveAll.addClass("hidden")},a=function(){$('[data-rel="tooltip"]').tooltip()},v=function(n){n=n.d;n.Status?(commonManger.showMessage("تم الحفظ",n.message),window.location.href="CompanyRents.aspx?id="+n.ID):n.message.indexOf("The duplicate key value is")>0?commonManger.showMessage("خطأ بالحفظ:","رقم الحوالة الذى ادخلته موجود بالفعل فى الحوالات مع اسم شركة الصرافة، برجاء اختيار رقم حوالة آخر أو شركة صرافة أخري."):commonManger.showMessage("خطأ بالحفظ:",n.message)};return{Init:f}}();
//# sourceMappingURL=RentDetails.min.js.map
