var cid="",vatType={Out:1,In:2},vatReports=function(){var i=function(){u();r();n(vatType.Out)},r=function(){$("#vatTabs li a").click(function(i){if($(this).parent("li").hasClass("active")){i.preventDefault();return}var r=$(this).attr("data-id")*1;r&&n(r);t(r)});$("strong[data-id]").click(function(){var i=$(this).attr("data-id"),r=$('a[data-id="'+i+'"]').parent("li");r.hasClass("active")||($("#vatTabs li").removeClass("active"),$('#vatTabs li a[data-id="'+i+'"]').parent("li").addClass("active"),n(i),t(i))});$("#btnSearchAll").click(function(t){t.preventDefault();var i=$("#vatTabs li.active a").attr("data-id");n(i)})},t=function(n){var t=$("#ClientID");n===1?t.prev("div").removeClass("hide"):t.prev("div").addClass("hide")},u=function(){var n=function(n){var r=commonManger.comp2json(n.d),i=r.list,t=r.list1,u;i&&($(".vatOutTotal").text(numeral(i.VatOutTotal).format("0,0")),u=i.VatOutTotal*1-(t.VatInTotal?t.VatInTotal*1:0),$(".DueTotalAmount").text(numeral(u).format("0,0")));t&&$(".vatInTotal").text(numeral(t.VatInTotal).format("0,0"))};dataService.callAjax("Post",JSON.stringify({actionName:"VatInOut_Summary"}),sUrl+"GetDataDirect",n,commonManger.errorException)},e=function(n){n=n.d;$(".modal").modal("hide");commonManger.showMessage("تم تنفيذ الإجراء بنجاح.",n.message);n.Status&&$("#listItems").DataTable().draw()},f=function(n){var t="VatOut";switch(n){case"2":case 2:t="VatIn"}return t},n=function(n){var t=$("#listItems").DataTable({sDom:"<'row-fluid'<'span6'l><'span6 lft-pane'BT>r>t<'row-fluid'<'span6'i><'span6'p>>",buttons:[{extend:"csv",text:"تصدير إكسيل"},{text:"طباعة",action:function(){$(".dataTables_length,.form-horizontal").closest("div.row-fluid").addClass("hidden-print");window.print()}}],bServerSide:!0,bRetrieve:!1,bDestroy:!0,stateSave:!0,sAjaxSource:sUrl+"LoadDataTablesXML",fnServerParams:function(t){var r=f(n),i;t.push({name:"funName",value:r+"_List"});i={typeId:$("#VatTypeID").val(),from:$("#From").val()!==""?commonManger.dateFormat($("#From").val()):"",to:$("#To").val()!==""?commonManger.dateFormat($("#To").val()):""};t.push({name:"names",value:["VatTypeID~From~To"+(i.typeId===1?"ClientID":"")]},{name:"values",value:[i.typeId+"~"+i.from+"~"+i.to+(i.typeId===1?"~"+$("#ClientID").val():"")]})},fnServerData:function(n,t,i){dataService.callAjax("GET",t,n,function(n){commonManger.setData2Grid(n,t.sEcho,i)},commonManger.errorException)},fnFooterCallback:function(n,t){for(var r=0,u=0,i=0;i<t.length;i++)r+=parseFloat(t[i].VAT)*1,t[i].SalePrice&&(u+=parseFloat(t[i].SalePrice)*3.667);$("._totalVat").text(numeral(r).format("0,0"));$("._total").text(numeral(u).format("0,0"))},iDisplayLength:50,aaSorting:[],aoColumns:[{mDataProp:"RefID",bSortable:!0,mData:function(n){return'<a href="'+n.URL+"?id="+n.RefID+'">'+n.RefID+"<\/a>"}},{mDataProp:"AddDate",bSortable:!0,mData:function(n){return n.AddDate?commonManger.formatJSONDateCal(n.AddDate):""}},{mDataProp:"VatTypeName",bSortable:!0,mData:function(n){return n.VatTypeName?n.VatTypeName:""}},{bSortable:!1,mData:function(n){return n.full_name?n.full_name:""}},{bSortable:!1,mData:function(n){return n.SalePrice?numeral(n.SalePrice*3.667).format("0,0.00"):0}},{mDataProp:"VAT",bSortable:!1,mData:function(n){return numeral(n.VAT).format("0,0.00")}}]})};return{Init:i}}();