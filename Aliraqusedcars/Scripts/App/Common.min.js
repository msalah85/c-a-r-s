$.fn.afterLoadDatawithdata=function(){};$.fn.afterLoadData=function(){};$.fn.afterSave=function(){};$.fn.beforeSave=function(){return!0};jQuery.fn.preventDoubleClick=function(){$(this).on("click",function(n){var t=$(this);t.data("clicked")?(n.preventDefault(),n.stopPropagation()):(t.data("clicked",!0),window.setTimeout(function(){t.removeData("clicked")},1e3))});return this};$(document).ready(function(){$("*").dblclick(function(n){return n.stopPropagation(),n.preventDefault(),console.log("double-clicked but did nothing"),!1})});var commonManger=function(){var i="/api/general.aspx/",o=function(n,t,i){$(".modal-header h3").html('<i class="icon-edit"><\/i> '+n+"");$("#"+i+"").attr("data-operation",t);$("#"+i+"").modal({show:!0})},s=function(t,i,u,f,e){var o=r(i);o&&dataService.callAjax("Post",JSON.stringify(f),u,e,n)},h=function(n){$("#"+n+" .modal-body").find("input, textarea, button, select").attr("disabled","disabled")},c=function(n){$("#"+n+" .modal-body").find("input, textarea, button, select").removeAttr("disabled")},t=function(n,t){$(".gritter-item-wrapper").remove();$.gritter.add({title:n,text:t,sticky:!1})},n=function(n,i,r){var u=i+": "+r,f=JSON.parse(n.responseText).Message;t(u,f);console.log(u+": "+f)},r=function(n){var t=$("#"+(n?n:"aspnetForm"));return t.valid()},l=function(n){var t=0,i;$(".dataTables_filter input").unbind("keypress keyup").bind("keypress keyup",function(){var r=$(this);t=0;i||(i=setInterval(function(){if(t>=3){clearInterval(i);i="";var u=$(r).val();n.fnFilter(u);t=0}t++},200))})},a=function(n){$("#"+n+"").find("input:not(.noreset)").each(function(){if($(this).attr("id")&&!$(this).hasClass("hasfunction")&&!$(this).hasClass("noreset")){var t=$(this).attr("id"),n=$(this).prop("type");n=="text"||n=="number"||n=="email"||n=="date"?$(this).hasClass("current-date")?$(this).val(moment().format("DD/MM/YYYY")):$(this).hasClass("select2")?$(this).select2("data",null):$(this).val(""):n=="checkbox"?$(this).prop("checked",!0):n=="hidden"?$(this).val(value="0"):n=="textarea"&&($(this).hasClass("textareaSpecial")?CKEDITOR.instances[t].setData("<p><\/p>"):$(this).val(value=""))}});$("#"+n+"").find("select:not(.noreset)").each(function(){if($(this).attr("name")){var n=$(this).attr("id"),t=$(this).prop("type");t=="select-one"&&($("#"+n).val(""),$("#"+n).hasClass("chzn-select")&&($(".chzn-select").val(""),$(".chzn-select").trigger("chosen:updated")))}});$("#"+n+" textarea:not(.noreset)").val("")},v=function(n,t){var i=[];$("#"+t).find("select:not(.notfill)").each(function(){var n=$(this).attr("id");n&&i.push(n)});$.each(n,function(t,r){if(n.tbl_name!=150&&n.tbl_name!=160)for(var u=0;u<i.length;u++)r.tbl_name==u&&($("#"+i[u]+"").append("<option value='"+r.ID+"'>"+r.Name+"<\/option>"),$("#"+i[u]+"").hasClass("chzn-select")&&$("#"+i[u]+"").chosen().trigger("chosen:updated").trigger("liszt:updated"))})},y=function(r,u,f){var e=[],o=[],s=tableName+"_Delete";$("#"+deleteModalDialog).find(".removeField").text().toLowerCase().indexOf(",")>=0?e=$("#"+deleteModalDialog).find(".removeField").text().split(","):e.push($("#"+deleteModalDialog).find(".removeField").text());pKey.toLowerCase().indexOf(",")>=0?o=pKey.split(","):o.push(pKey);DTO={Ids:e,ActionName:s,Parm_name:o};r=$("#"+r);dataService.callAjax("Post",JSON.stringify(DTO),i+"Delete_Data",function(n){$(r).modal("hide");n.d.Status?f(n):t("خطأ بالحذف:","خطأ أثناء الحذف "+n.d.message)},n)},p=function(r,u,f,e,o,s){var h=[],c=[],l=e+"_Delete";String(s).indexOf(",")>=0?h=s.split(","):h.push(s);String(o).indexOf(",")>=0?c=o.split(","):c.push(o);DTO={Ids:h,ActionName:l,Parm_name:c};r=$("#"+r);dataService.callAjax("Post",JSON.stringify(DTO),i+"Delete_Data",function(n){$(r).modal("hide");n.d.Status?u(n):t("لم تتم عملية الحذف",n.d.message)},n)},w=function(r,u,f,e,o,s){var h=[],c=[],l=e+"_Delete";h.push(s);c.push(o);DTO={Ids:h,ActionName:l,Parm_name:c};r=$("#"+r);dataService.callAjax("Post",JSON.stringify(DTO),i+"Delete_Data",function(n){$(r).modal("hide");n.d.Status?u(n):t("لم تتم عملية الحذف",n.d.message)},n)},b=function(n,t){$("#"+t+"").find("input,select,textarea,label").each(function(){var t,i,r;$(this).attr("id")&&($(this).hasClass("notneed")||(ElementId=$(this).attr("id"),t=$(this).prop("type"),(t!="undefined"||t!="")&&(t=="text"||t=="hidden"||t=="number"||t=="email"||t=="date"||t=="textarea"?$(this).hasClass("textareaSpecial")?CKEDITOR.instances[ElementId].setData(n[ElementId]):$(this).hasClass("date-picker")?$(this).val(f(n[ElementId],$(this).attr("date-current-format"),$(this).attr("date-to-format"))):(i=n[ElementId]+"",i.toLowerCase().indexOf("date(")>0?$(this).val(e(n[ElementId])):$(this).val(value=n[ElementId])):t=="select-one"&&$("#"+ElementId).hasClass("showvalue")?$("#"+ElementId+" option").filter(function(){return $(this).text()===n[ElementId]}).attr("selected","selected"):t!="select-one"||$("#"+ElementId).hasClass("showvalue")?t=="checkbox"?$(this).prop("checked",n[ElementId]):$(this).is("label")&&($(this).hasClass("date-picker")?(r=f(n[ElementId],"M/D/YYYY","DD/MM/YYYY"),$(this).text(r)):$("#"+ElementId+"").text(n[ElementId])):($("#"+ElementId).val(n[ElementId]),$("#"+ElementId).hasClass("chzn-select")&&$("#"+ElementId).chosen().trigger("chosen:updated").trigger("liszt:updated")))))});$.fn.afterLoadData();$.fn.afterLoadDatawithdata(n)},k=function(){var n=i+"load_goalble_list",r={funName:tableName+"_Properties"};dataService.callAjax("Post",JSON.stringify(r),n,function(n){var t=JSON.parse(n.d);bindListsOnForm(t,formName);bindListsOnForm(t,detailsForm)},function(n,i,r){var u=i+": "+r,f=JSON.parse(n.responseText).Message;t("danger",u,f)})},d=function(){for(var t=[],n,r=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),i=0;i<r.length;i++)n=r[i].split("="),t.push(n[0]),t[n[0]]=n[1];return t},g=function(){return today_date=new Date,today_Date_Str=(today_date.getDate()<10?"0":"")+(today_date.getMonth()<9?"0":"")+String(today_date.getMonth()+1)+""+String(today_date.getDate()+""+today_date.getFullYear())},nt=function(n){var t=[];return $("#"+n).find("input,select,textarea").each(function(){$(this).attr("id")&&($(this).hasClass("notneed")||($(this).hasClass("notshow")?t.push("hide"+$(this).attr("id")):t.push($(this).attr("id"))))}),t},tt=function(n){var t=[];return $("#"+n+"").find("input,select,textarea").each(function(){$(this).attr("id")&&($(this).hasClass("notneed")||$(this).hasClass("notsave")||t.push($(this).attr("id")))}),t},it=function(t,r,f,e,o,s,h,c){var l=[],a=[],v=u(r),y;a=v[0];l=v[1];y={values:l,actionName:h,Parm_names:a,fieldsDetails:o,valuesDetails:s,flage:c};dataService.callAjax("Post",JSON.stringify(y),i+"SaveDataMasterDetails",function(n){commonManger.showMessage("تم الحفظ بنجاح:",n.d.message);$.fn.afterSave(l);f(n)},n)},u=function(n){var t=[],i=[],r=[],u="";return $("#"+n).find("input,select,textarea").each(function(){var n,r,e,o;$(this).attr("id")&&($(this).hasClass("notneed")||(u=$(this).attr("id"),n=$(this).prop("type"),(n!="undefined"||n!="")&&(n=="text"||n=="hidden"||n=="number"||n=="email"||n=="date"||n=="tel"?($(this).hasClass("date-picker")?t.push(f($(this).val())):t.push($(this).val()),i.push($(this).attr("id"))):n=="hidden"?($(this).val()==""?t.push("0"):t.push($(this).val()),i.push($(this).attr("id"))):n=="select-one"?(t.push($(this).find("option:selected").val()),i.push($(this).attr("id"))):n=="checkbox"?($(this).prop("checked",function(n,i){t.push(i)}),i.push($(this).attr("id"))):n=="radio"?(r=$(this).attr("name"),e=$('input[name="'+r+'"]:checked').val(),t.push(e),i.push(r)):n=="textarea"&&($(this).hasClass("textareaSpecial")?(o=CKEDITOR.instances.Details.getData(),t.push(o),i.push($(this).attr("id"))):(t.push($(this).val()),i.push($(this).attr("id")))))))}),r.push(i,t),r},rt=function(f,e,o){var l,a;if($.fn.beforeSave()){var s=[],h=[],c=u(formName),v=tableName+"_Save";h=c[0];s=c[1];l={values:s,actionName:v,Parm_names:h};f=$("#"+f);a=r(e);a&&dataService.callAjax("Post",JSON.stringify(l),i+"saveDefaultData",function(n){console.log(n);$(f).modal("hide");n.d.Status?o(n):t("خطأ أثناء الحفظ",n.d.message);commonManger.ResetControls(formName)},n)}},ut=function(f,e,o,s,h,c,l){var a=[],v=[],y=u(e),p;v=y[0];a=y[1];DTO={values:a,actionName:h,Parm_names:v,flage:c};f=$("#"+f);p=r(e);p?dataService.callAjax("Post",JSON.stringify(DTO),i+"saveData",function(n){n=n.d;$(f).modal("hide");n.Status?(o(n),l(n.serializdata),commonManger.showMessage("تم بنجاح:","تم الحفظ بنجاح:")):commonManger.showMessage("خطأ أثناء الحفظ",n.message);commonManger.ResetControls(e)},n):($(f).modal("hide"),t("حقول مطلوبة","برجاء التأكد من اختيار جميع الحقول الاجبارية."))},ft=function(){commonManger.showMessage("تم الحذف بنجاح.","تمت عملية الحذف بنجاح.");$("#listItems").DataTable().draw()},et=function(n){n=n.d;n.Status?(commonManger.showMessage("تم الحفظ بنجاح.","تمت عملية الحفظ بنجاح."),$("#listItems").dataTable().fnDraw()):commonManger.showMessage("لم يتم الحفظ.","خطأ فى الحفظ:"+n.messages)},ot=function(n){return n!==undefined&&n!==null&&n.length>0?n.replace(/[^\d.]/g,""):0},st=function(){for(var t=[],n,r=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),i=0;i<r.length;i++)n=r[i].split("="),t.push(n[0]),t[n[0]]=n[1];return t},ht=function(n){return $(n).text()},e=function(n,t){if(n==null)return"";var i=new Date(parseInt(n.substr(6)));return t?i.getMonth()+1+"/"+i.getDate()+"/"+i.getFullYear():i.getDate()+"/"+(i.getMonth()+1)+"/"+i.getFullYear()},ct=function(n,t){if(!n||n=="")return"";t===undefined&&(t="dd/MM/yyyy");return $.format.date(n,t)},f=function(n,t,i){if(!n||n=="")return"";t=t?t:"D/M/YYYY";i=i?i:"MM/DD/YYYY";var r=moment(n,t);return r.format(i)},lt=function(n,t,i){return t=t||".",i=i||2,n.toLocaleString().split(t)[0]+t+n.toFixed(i).split(t)[1]},at=function(n){$("div.page-header h1 small").remove();$("div.page-header h1").append($(" <small>"+n+"<\/small>"))},vt=function(n,t){return $("#"+t).DataTable({sDom:"<'row'>t<'row'>",bDestroy:!0,bLengthChange:!1,bFilter:!1,searching:!1,retrieve:!0,paging:!1,data:n,drawCallback:function(){if($.isFunction($.fn.editable)){var n=this.api();$("a.editable",n.table().body()).editable({validate:function(n){return $.trim(n)===""?"مطلوب.":isNaN(n)?"رقم فقط!":void 0},url:function(n){return n.table=$(this).data("table"),n.id=$(this).data("id"),$.ajax({type:"POST",url:sUrl+"InlineEdit",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",dataType:"json",async:!0,cache:!1,timeout:1e4,success:function(n){$.fn.afterSave(n);commonManger.showMessage("تم الحفظ:","تم حفظ المبلغ بنجاح.")},error:function(){commonManger.showMessage("خطأ:","لقد حدث خطأ فى تنفيذ الإجراء.")}})}})}}})};return seoUrl=function(n){return n.replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi,"")},num2Arabic=function(t,i){if(t&&$.isNumeric(t)){var r={amount:t,dollarDirham:i};dataService.callAjax("Post",JSON.stringify(r),sUrl+"Money2Arabic",function(n){$.fn.afterSave(n)},n)}},prepareData2Grid=function(n,t,i){var f=comp2Json(n.d),u=f.list,r=f.list1,e;r=r?$.map(r,function(n){return n}):[0];e={sEcho:t?t:0,iTotalRecords:r[0],iTotalDisplayRecords:r[0],aaData:$.isArray(u)?u:$.makeArray(u)};i(e)},disableControl=function(n,t){$("#"+n).prop("disabled",t)},editableSave=function(t,i,r){return $.ajax({type:"POST",url:r?r:sUrl+"InlineEdit",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",dataType:"json",async:!0,cache:!1,timeout:1e4,success:function(n){i(n.d)},error:n})},fullRoles=function(){var n=$("level").attr("content");return n==="1"?!0:!1},comp2Json=function(n){var t=LZString.decompressFromUTF16(n),i=$.parseXML(t);return $.xml2json(i)},{showPopUpDialog:o,doWork:s,showMessage:t,searchData:l,applyValidation:r,disableAllFormElements:h,enableAllFormElements:c,ResetControls:a,Filllist:v,getDataForUpdate:b,getUrlVars:d,returnFiledsNames:nt,returnFiledsNamesToSave:tt,SaveDataMasterDetails:it,Returncontrolsval:u,getCurrentDate:g,saveData:ut,saveDefaultData:rt,deleteDefaultData:y,deleteData:p,getNumbersFromString:ot,getQueryStrs:st,getStringFromHTML:ht,errorException:n,formatJSONDate:e,formatCurrency:lt,showOptionPrintTitle:at,deleteMultipleData:w,successDeleted:ft,formatJSONDateCal:ct,dateFormat:f,successSaved:et,fillLists:k,populateDataTable:vt,seoUrl:seoUrl,num2Arabic:num2Arabic,disableControl:disableControl,setData2Grid:prepareData2Grid,saveEditable:editableSave,fullRoles:fullRoles,comp2json:comp2Json}}();$.isFunction($.fn.editable)&&($.fn.editable.defaults.mode="inline",$("a[data-type=text].editable").editable({url:function(n){return n.table=$(this).data("table"),n.id=$(this).data("id"),$.ajax({type:"POST",url:sUrl+"InlineEdit",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",dataType:"json",async:!0,cache:!1,timeout:1e4,success:function(){},error:function(){console.log("Error in Ajax!..")}})}}));