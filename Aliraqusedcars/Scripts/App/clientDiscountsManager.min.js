$.extend(!0,$.fn.dataTable.defaults,{searching:!1});modalDialog="addModal";tableName="ClientDiscounts";pKey="ClientDiscountID";gridId="listItems";gridColumns=[];formName="aspnetForm";filterNames="ClientID";clientId=commonManger.getQueryStrs().id;filterValues=clientId;getClientName=function(){var n=tableName+"_Properties",t={actionName:n,value:clientId},i=function(n){var i=commonManger.comp2json(n.d),t=i.list;t&&$(".client-name").text(t.full_name)};dataService.callAjax("Post",JSON.stringify(t),sUrl+"GetData",i,commonManger.errorException)};$.fn.beforeSave=function(){var n=$("#CarID").val(),t=$("#Notes").val();return!$.isNumeric(n)&&!(n*1>0)?(commonManger.showMessage("بيانات مطلوبة","يرجي اختيار رقم السيارة أولاً."),DefaultGridManager.btnProceessing($('.btn[type="submit"]'),!1),!1):t===""?(DefaultGridManager.btnProceessing($('.btn[type="submit"]'),!1),!1):!0};getClientName();$("#ClientID").val(clientId);$("#clientLink,.client-name").attr("href","ClientCars.aspx?id="+clientId);gridColumns.push({mDataProp:"ClientDiscountID",bSortable:!0},{mDataProp:"CarID",bSortable:!0,mData:function(n){return'<a title="تفاصيل السيارة" href="CarDetailsPrint.aspx?id='+n.CarID+'">'+n.CarID+"<\/a>"}},{mDataProp:"AddDate",bSortable:!0,mData:function(n){return commonManger.formatJSONDateCal(n.AddDate,"dd/MM/yyyy")}},{mDataProp:"Notes",bSortable:!1},{mDataProp:"DiscountAmount",bSortable:!1,mData:function(n){return numeral(n.DiscountAmount).format("0,0")}},{bSortable:!1,mData:function(){var n=commonManger.fullRoles();return n?'<button class="btn btn-danger btn-mini remove" title="حذف"><i class="icon-trash"><\/i><\/button>':""}});DefaultGridManager.Init();$("#btnDelete").click(function(n){n.preventDefault();var t={id:$(".removeField").text(),reason:$("#Reason")},i={actionName:tableName+"_Delete",names:["id","reason"],values:[t.id,t.reason.val()]},r=function(n){n=n.d;n.Status?commonManger.showMessage("تم الحذف",n.message):commonManger.showMessage("لم يتم الحذف","حدث خطأ اثناء الحذف"+n.message);DefaultGridManager.updateGrid();$(".modal").modal("hide")};t.reason.val()!==""?dataService.callAjax("Post",JSON.stringify(i),sUrl+"saveData",r,commonManger.errorException):(t.reason.focus(),commonManger.showMessage("بيانات مطلوبة","يرجي ادخال سبب الحذف"))});$(".modal").on("hide.bs.modal",function(){$("#Reason").val("");$("#Reason").focus()});