var printSaleCarsBill=printSaleCarsBill||{};(function(){var n=document.createElement("a"),u=function(t){var r=$(t).clone()[0],i;return r.nodeName.toLowerCase()==="link"&&(n.href=r.href,i=n.host,i.indexOf("/")===-1&&n.pathname.indexOf("/")!==0&&(i+="/"),r.href=n.protocol+"//"+i+n.pathname+n.search),r.nodeName.toLowerCase()==="img"&&(n.href=r.src,i=n.host,i.indexOf("/")===-1&&n.pathname.indexOf("/")!==0&&(i+="/"),r.src=n.protocol+"//"+i+n.pathname+n.search),r.outerHTML},f=function(t){var r,u=$(t).clone()[0],i;return u.nodeName.toLowerCase()==="img"&&(n.href=u.src,i=n.host,i.indexOf("/")===-1&&n.pathname.indexOf("/")!==0&&(i+="/"),r=n.protocol+"//"+i+n.pathname+n.search),r},i="",e=function(n){var t=function(n){var f=commonManger.comp2json(n.d),l=f.list,e=f.list1,s=f.list2,t="",h=$(i).clone(!0),a=h.filter("div.container"),c=function(n,i,r,f){var e=$("<div />",{html:t});e.find(n+" ."+i+"-list tbody").html(u(r)).closest("div.span6").removeClass("hidden").find(".carTotal").text(numeral(f).format("0,0"));t=e.html()};$(l).each(function(n,i){var u=n===0?h:a,v;$(u).attr("id","InvoiceNo_"+n);$("#ContentPlaceHolder1_divInvoiceNo",u).text(i.SaleInvoiceID);$("#ContentPlaceHolder1_clientAccount",u).text(i.full_name);$("#ContentPlaceHolder1_toDay",u).text(commonManger.formatJSONDateCal(i.InvoiceDate));$("#ContentPlaceHolder1_divModel",u).text(i.MakerNameEn+" - "+i.TypeNameEn);$("#ContentPlaceHolder1_divYear",u).text(i.Year);$("#ContentPlaceHolder1_CarID",u).text(i.CarID);$("#ContentPlaceHolder1_divLotNo",u).text(i.LotNo);$("#ContentPlaceHolder1_divChassis",u).text(i.ChassisNo);$("#ContentPlaceHolder1_divStatus",u).text(i.WorkingStatusName);$("#ContentPlaceHolder1_divColor",u).text(i.ColorNameEn);$("#ContentPlaceHolder1_DivGear",u).text(i.TransmissionNameEn);$("#ContentPlaceHolder1_divArriveDate",u).text(commonManger.formatJSONDateCal(i.ArrivalDate));$("#ContentPlaceHolder1_divSaleTypeName",u).text(i.SaleTypeName);$("#ContentPlaceHolder1_divNotes",u).text(i.Notes);$("#ContentPlaceHolder1_divPrice",u).text(numeral(i.PayPrice).format("0,0"));$(".ace-thumbnails",u).html(`<img class="thumb" src="/public/cars/${i.CarID}/${i.MainPicture}" />`);v=r(u);t+=v+"<br>";var f=i.PayPrice*1,y="#InvoiceNo_"+n,p=i.CarID,o=[],l=[];e&&(l=$(e).map(function(n,t){if(t.CarID===i.CarID)return f+=t.ExtraAmount*1,{Notes:t.Notes,Amount:t.ExtraAmount}}));s&&(o=$(s).map(function(n,t){if(t.CarID===i.CarID)return f-=t.DiscountAmount*1,{Notes:t.Notes,Amount:t.DiscountAmount}}));o.length>0&&c(y,"disc",o,f);l.length>0&&c(y,"extra",l,f)});o(t)},u=function(n){return $(n).map(function(n,t){return`<tr><td>${numeral(t.Amount).format("0,0")}</td><td>${t.Notes}</td></tr>`}).get().join("")},f={actionName:"CarSaleInvoices_ByBol",value:n};dataService.callAjax("POST",JSON.stringify(f),sUrl+"GetData",t,commonManger.errorException)},t=function(n,t){var i=$("<div>"+n+"<\/div>");return i.find(t).remove(),i.html()},o=function(n){var i=window.open("",""),e="<title>طباعة فواتير البيع<\/title>",t;$(n).filter("link").each(function(){e+=u(this)});t=$(n).clone(!0);$("img",t).attr("src",function(){return f(this)});$(i.document.head).html(e);$(i.document.body).html('<div id="content">'+r(t)+"<\/div>")},r=function(n){var t=document.createElement("div");return $(t).html(n),$(t).html()},s=function(n,r){n=t(n,"title,div.stickyFooter.hidden-print,button,.printme,.delete-wpr,.widget-box");n=t(n,'script[src*="/Scripts/App/carsaleInvoicesManager"]');n=t(n,'script[src*="signature/js/canvg"]');n=t(n,'script[src*="signature/js/jquery.signature"]');i=n+`<style>@media print {@page { margin: 0; }.container{ page-break-before: always; }}</style>`;e(r)};printSaleCarsBill.printBolCars=function(n){$.get("/admin-admin-2015/InvoiceSalePrint.aspx",function(t){s(t,n)},"html")}})();