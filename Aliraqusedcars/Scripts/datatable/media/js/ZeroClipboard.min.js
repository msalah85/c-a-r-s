var ZeroClipboard_TableTools={version:"1.0.4-TableTools2",clients:{},moviePath:"",nextId:1,$:function(n){return typeof n=="string"&&(n=document.getElementById(n)),n.addClass||(n.hide=function(){this.style.display="none"},n.show=function(){this.style.display=""},n.addClass=function(n){this.removeClass(n);this.className+=" "+n},n.removeClass=function(n){this.className=this.className.replace(new RegExp("\\s*"+n+"\\s*")," ").replace(/^\s+/,"").replace(/\s+$/,"")},n.hasClass=function(n){return!!this.className.match(new RegExp("\\s*"+n+"\\s*"))}),n},setMoviePath:function(n){this.moviePath=n},dispatch:function(n,t,i){var r=this.clients[n];r&&r.receiveEvent(t,i)},register:function(n,t){this.clients[n]=t},getDOMObjectPosition:function(n){var t={left:0,top:0,width:n.width?n.width:n.offsetWidth,height:n.height?n.height:n.offsetHeight};for(n.style.width!=""&&(t.width=n.style.width.replace("px","")),n.style.height!=""&&(t.height=n.style.height.replace("px",""));n;)t.left+=n.offsetLeft,t.top+=n.offsetTop,n=n.offsetParent;return t},Client:function(n){this.handlers={};this.id=ZeroClipboard_TableTools.nextId++;this.movieId="ZeroClipboard_TableToolsMovie_"+this.id;ZeroClipboard_TableTools.register(this.id,this);n&&this.glue(n)}};ZeroClipboard_TableTools.Client.prototype={id:0,ready:!1,movie:null,clipText:"",fileName:"",action:"copy",handCursorEnabled:!0,cssEffects:!0,handlers:null,sized:!1,glue:function(n,t){var u,i,r;this.domElement=ZeroClipboard_TableTools.$(n);u=99;this.domElement.style.zIndex&&(u=parseInt(this.domElement.style.zIndex)+1);i=ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement);this.div=document.createElement("div");r=this.div.style;r.position="absolute";r.left="0px";r.top="0px";r.width=i.width+"px";r.height=i.height+"px";r.zIndex=u;typeof t!="undefined"&&t!=""&&(this.div.title=t);i.width!=0&&i.height!=0&&(this.sized=!0);this.domElement&&(this.domElement.appendChild(this.div),this.div.innerHTML=this.getHTML(i.width,i.height).replace(/&/g,"&amp;"))},positionElement:function(){var n=ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement),t=this.div.style,i;if(t.position="absolute",t.width=n.width+"px",t.height=n.height+"px",n.width!=0&&n.height!=0)this.sized=!0;else return;i=this.div.childNodes[0];i.width=n.width;i.height=n.height},getHTML:function(n,t){var i="",r="id="+this.id+"&width="+n+"&height="+t,u;return navigator.userAgent.match(/MSIE/)?(u=location.href.match(/^https/i)?"https://":"http://",i+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+u+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" width="'+n+'" height="'+t+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+ZeroClipboard_TableTools.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+r+'"/><param name="wmode" value="transparent"/><\/object>'):i+='<embed id="'+this.movieId+'" src="'+ZeroClipboard_TableTools.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+n+'" height="'+t+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+r+'" wmode="transparent" />',i},hide:function(){this.div&&(this.div.style.left="-2000px")},show:function(){this.reposition()},destroy:function(){if(this.domElement&&this.div){this.hide();this.div.innerHTML="";var n=document.getElementsByTagName("body")[0];try{n.removeChild(this.div)}catch(t){}this.domElement=null;this.div=null}},reposition:function(n){if(n&&(this.domElement=ZeroClipboard_TableTools.$(n),this.domElement||this.hide()),this.domElement&&this.div){var t=ZeroClipboard_TableTools.getDOMObjectPosition(this.domElement),i=this.div.style;i.left=""+t.left+"px";i.top=""+t.top+"px"}},clearText:function(){this.clipText="";this.ready&&this.movie.clearText()},appendText:function(n){this.clipText+=n;this.ready&&this.movie.appendText(n)},setText:function(n){this.clipText=n;this.ready&&this.movie.setText(n)},setCharSet:function(n){this.charSet=n;this.ready&&this.movie.setCharSet(n)},setBomInc:function(n){this.incBom=n;this.ready&&this.movie.setBomInc(n)},setFileName:function(n){this.fileName=n;this.ready&&this.movie.setFileName(n)},setAction:function(n){this.action=n;this.ready&&this.movie.setAction(n)},addEventListener:function(n,t){n=n.toString().toLowerCase().replace(/^on/,"");this.handlers[n]||(this.handlers[n]=[]);this.handlers[n].push(t)},setHandCursor:function(n){this.handCursorEnabled=n;this.ready&&this.movie.setHandCursor(n)},setCSSEffects:function(n){this.cssEffects=!!n},receiveEvent:function(n,t){var r,u,f,i;n=n.toString().toLowerCase().replace(/^on/,"");switch(n){case"load":if(this.movie=document.getElementById(this.movieId),!this.movie){r=this;setTimeout(function(){r.receiveEvent("load",null)},1);return}if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/)){r=this;setTimeout(function(){r.receiveEvent("load",null)},100);this.ready=!0;return}this.ready=!0;this.movie.clearText();this.movie.appendText(this.clipText);this.movie.setFileName(this.fileName);this.movie.setAction(this.action);this.movie.setCharSet(this.charSet);this.movie.setBomInc(this.incBom);this.movie.setHandCursor(this.handCursorEnabled);break;case"mouseover":this.domElement&&this.cssEffects&&this.recoverActive&&this.domElement.addClass("active");break;case"mouseout":this.domElement&&this.cssEffects&&(this.recoverActive=!1,this.domElement.hasClass("active")&&(this.domElement.removeClass("active"),this.recoverActive=!0));break;case"mousedown":this.domElement&&this.cssEffects&&this.domElement.addClass("active");break;case"mouseup":this.domElement&&this.cssEffects&&(this.domElement.removeClass("active"),this.recoverActive=!1)}if(this.handlers[n])for(u=0,f=this.handlers[n].length;u<f;u++)i=this.handlers[n][u],typeof i=="function"?i(this,t):typeof i=="object"&&i.length==2?i[0][i[1]](this,t):typeof i=="string"&&window[i](this,t)}};
//# sourceMappingURL=ZeroClipboard.min.js.map
