(function(n){"use strict";n.fn.rowGrouping=function(t){function i(){}function r(){}function u(){}function f(n){return["January","February","March","April","May","June","July","August","September","October","November","December"][n-1]}var e={iGroupingColumnIndex:0,sGroupingColumnSortDirection:"",iGroupingOrderByColumnIndex:-1,sGroupingClass:"group",sGroupItemClass:"group-item",bHideGroupingColumn:!0,bHideGroupingOrderByColumn:!0,sGroupBy:"name",sGroupLabelPrefix:"",fnGroupLabelFormat:function(n){return n},bExpandableGrouping:!1,bExpandSingleGroup:!1,iExpandGroupOffset:100,asExpandedGroups:null,sDateFormat:"dd/MM/yyyy",sEmptyGroupLabel:"-",bSetGroupingClassOnTR:!1,iGroupingColumnIndex2:-1,sGroupingColumnSortDirection2:"",iGroupingOrderByColumnIndex2:-1,sGroupingClass2:"subgroup",sGroupItemClass2:"subgroup-item",bHideGroupingColumn2:!0,bHideGroupingOrderByColumn2:!0,sGroupBy2:"name",sGroupLabelPrefix2:"",fnGroupLabelFormat2:function(n){return n},bExpandableGrouping2:!1,fnOnGrouped:i,fnOnGroupCreated:r,fnOnGroupCompleted:u,oHideEffect:null,oShowEffect:null,bUseFilteringForGrouping:!1};return this.each(function(i,r){function ot(t,i,r){var s=document.createElement("tr"),f=document.createElement("td"),e;return s.id="group-id-"+o.attr("id"),e={id:s.id,key:t,text:i,level:0,groupItemClass:".group-item-"+t,dataGroup:t,aoSubgroups:[]},u.bSetGroupingClassOnTR?s.className=u.sGroupingClass+" alert alert-warning ":f.className=u.sGroupingClass+" alert alert-warning ",f.colSpan=r,f.innerHTML=u.sGroupLabelPrefix+u.fnGroupLabelFormat(i==""?u.sEmptyGroupLabel:i,e),u.bExpandableGrouping&&(y(t)?(f.className+=" collapsed-group",e.state="collapsed"):(f.className+=" expanded-group",e.state="expanded"),f.className+=" group-item-expander",n(f).attr("data-group",e.dataGroup),n(f).attr("data-group-level",e.level),n(f).click(it)),n(f).attr("style","background-color: #fcf8e3!important;"),s.appendChild(f),h[t]=e,e.nGroup=s,u.fnOnGroupCreated(e,t,1),e}function st(t,i,r,f){var s=document.createElement("tr");s.id=f.id+"_"+t;var o=document.createElement("td"),c=f.dataGroup+"_"+t,e={id:s.id,key:t,text:i,level:f.level+1,groupItemClass:".group-item-"+c,dataGroup:c,aoSubgroups:[]};return u.bSetGroupingClassOnTR?s.className=u.sGroupingClass2+" alert alert-warning ":o.className=u.sGroupingClass2+" alert alert-warning ",o.colSpan=r,o.innerHTML=u.sGroupLabelPrefix2+u.fnGroupLabelFormat2(i==""?u.sEmptyGroupLabel:i,e),u.bExpandableGrouping&&(s.className+=" group-item-"+f.dataGroup),u.bExpandableGrouping&&u.bExpandableGrouping2&&(y(e.dataGroup)?(o.className+=" collapsed-group",e.state="collapsed"):(o.className+=" expanded-group",e.state="expanded"),o.className+=" group-item-expander",n(o).attr("data-group",e.dataGroup),n(o).attr("data-group-level",e.level),n(o).click(it)),n(o).attr("style","border-top:0!important;"),n(s).attr("style","background-color: #fcf8e3!important;"),s.appendChild(o),f.aoSubgroups[e.dataGroup]=e,h[e.dataGroup]=e,e.nGroup=s,u.fnOnGroupCreated(e,t,2),e}function y(t){if(h[t]!=null)return h[t].state=="collapsed";if(t.indexOf("_")>-1)!0;else return v&&(c==null||c.length==0)?!1:n.inArray(t,c)==-1}function k(n){return n.length<p+w?n:n.substr(p,w)}function d(n){return n}function g(n){return n.substr(0,1)}function ht(n){return k(n)}function ct(n){return n.substr(p,w)+" "+f(n.substr(vt,yt))}function s(n){return n===undefined||n===null||n===""?"-":n.toLowerCase().replace(/[^a-zA-Z0-9\u0080-\uFFFF]+/g,"-")}function lt(n,t,i){if(n.nTable.id!==o[0].id)return!0;var r=t[u.iGroupingColumnIndex];return(typeof r=="undefined"&&(r=t[n.aoColumns[u.iGroupingColumnIndex].mDataProp]),y(s(r)))?(o.fnIsOpen(o.fnGetNodes(i))&&(u.fnOnRowClosed!=null&&u.fnOnRowClosed(this),o.fnClose(o.fnGetNodes(i))),!1):!0}function nt(t){if(h[t].state="expanded",n("td[data-group^='"+t+"']").removeClass("collapsed-group"),n("td[data-group^='"+t+"']").addClass("expanded-group"),u.bUseFilteringForGrouping){o.fnDraw();return}jQuery.inArray(t,c)==-1&&c.push(t);u.oHideEffect!=null?n(".group-item-"+t,o)[u.oShowEffect.method](u.oShowEffect.duration,u.oShowEffect.easing,function(){}):n(".group-item-"+t,o).show()}function tt(t){if(h[t].state="collapsed",n("td[data-group^='"+t+"']").removeClass("expanded-group"),n("td[data-group^='"+t+"']").addClass("collapsed-group"),u.bUseFilteringForGrouping){o.fnDraw();return}n(".group-item-"+t).each(function(){o.fnIsOpen(this)&&(u.fnOnRowClosed!=null&&u.fnOnRowClosed(this),o.fnClose(this))});u.oHideEffect!=null?n(".group-item-"+t,o)[u.oHideEffect.method](u.oHideEffect.duration,u.oHideEffect.easing,function(){}):n(".group-item-"+t,o).hide()}function it(t){var i=n(this).attr("data-group"),s=n(this).attr("data-group-level"),f=!y(i),e,r;u.bExpandSingleGroup?f||(e=n("td.expanded-group").attr("data-group"),tt(e),nt(i),u.iExpandGroupOffset!=-1?(r=n("#group-id-"+o.attr("id")+"_"+i).offset().top-u.iExpandGroupOffset,window.scroll(0,r)):(r=o.offset().top,window.scroll(0,r))):f?tt(i):nt(i);t.preventDefault()}function at(t){var b,r,k,d,f,p,i,g,l,e,ut,it;if(o.fnSettings().oFeatures.bServerSide&&(v=!0),b=!1,u.iGroupingColumnIndex2!=-1&&(b=!0),t.aiDisplayMaster.length!=0){for(r=n("tbody tr",o),k=0,d=0;d<t.aoColumns.length;d++)t.aoColumns[d].bVisible&&(k+=1);if(f=null,p=null,t.aiDisplay.length>0)for(i=0;i<r.length;i++){g=t._iDisplayStart+i;o.fnSettings().oFeatures.bServerSide&&(g=i);var tt="",l=null,nt="",w=null;if(tt=this.fnGetData(r[i],u.iGroupingColumnIndex),l=tt,u.sGroupBy!="year"&&(l=a(tt)),b&&(nt=t.aoData[t.aiDisplay[g]]._aData[u.iGroupingColumnIndex2],nt==undefined&&(nt=t.aoData[t.aiDisplay[g]]._aData[t.aoColumns[u.iGroupingColumnIndex2].mDataProp]),u.sGroupBy2!="year"&&(w=a(nt))),(f==null||s(l)!=s(f))&&(e=s(l),f!=null&&u.fnOnGroupCompleted(h[s(f)]),u.bAddAllGroupsAsExpanded&&jQuery.inArray(e,c)==-1&&c.push(e),ut=ot(e,l,k),it=ut.nGroup,r[i].parentNode!=null?r[i].parentNode.insertBefore(it,r[i]):n(r[i]).before(it),f=l,p=null),n(r[i]).attr("data-group",h[e].dataGroup),n(r[i]).addClass(u.sGroupItemClass),n(r[i]).addClass("group-item-"+e),u.bExpandableGrouping&&y(e)&&!u.bUseFilteringForGrouping&&n(r[i]).hide(),b){if(p==null||s(w)!=s(p)){var ft=s(l)+"-"+s(w),rt=st(ft,w,k,h[e]),et=rt.nGroup;r[i].parentNode.insertBefore(et,r[i]);p=w}n(r[i]).attr("data-group",rt.dataGroup).addClass(u.sGroupItemClass2).addClass("group-item-"+rt.dataGroup)}}f!=null&&u.fnOnGroupCompleted(h[s(f)]);u.fnOnGrouped(h);v=!1}}var o=n(r).dataTable(),h=[],rt,l,et,b;n(this).dataTableExt.aoGroups=h;var p=6,w=4,c=[],v=!0,u=n.extend(e,t);u.iGroupingOrderByColumnIndex==-1?(u.bCustomColumnOrdering=!1,u.iGroupingOrderByColumnIndex=u.iGroupingColumnIndex):u.bCustomColumnOrdering=!0;u.sGroupingColumnSortDirection==""&&(u.sGroupingColumnSortDirection=u.sGroupBy=="year"?"desc":"asc");u.iGroupingOrderByColumnIndex2==-1?(u.bCustomColumnOrdering2=!1,u.iGroupingOrderByColumnIndex2=u.iGroupingColumnIndex2):u.bCustomColumnOrdering2=!0;u.sGroupingColumnSortDirection2==""&&(u.sGroupingColumnSortDirection2=u.sGroupBy2=="year"?"desc":"asc");p=u.sDateFormat.toLowerCase().indexOf("yy");w=u.sDateFormat.toLowerCase().lastIndexOf("y")-u.sDateFormat.toLowerCase().indexOf("y")+1;var vt=u.sDateFormat.toLowerCase().indexOf("mm"),yt=u.sDateFormat.toLowerCase().lastIndexOf("m")-u.sDateFormat.toLowerCase().indexOf("m")+1,a=d;switch(u.sGroupBy){case"letter":a=g;break;case"year":a=ht;break;case"month":a=ct;break;default:a=d}if(u.asExpandedGroups!=null){if(u.asExpandedGroups=="NONE")u.asExpandedGroups=[],c=u.asExpandedGroups,v=!1;else if(u.asExpandedGroups=="ALL")u.bAddAllGroupsAsExpanded=!0;else if(u.asExpandedGroups.constructor==String)rt=u.asExpandedGroups,u.asExpandedGroups=[],u.asExpandedGroups.push(s(rt)),c=u.asExpandedGroups,v=!1;else if(u.asExpandedGroups.constructor==Array){for(l=0;l<u.asExpandedGroups.length;l++)if(c.push(s(u.asExpandedGroups[l])),u.bExpandSingleGroup)break;v=!1}}else u.asExpandedGroups=[],u.bAddAllGroupsAsExpanded=!0;if(u.bExpandSingleGroup){var pt=n("tbody tr",o),ut=o.fnGetData(pt[0],u.iGroupingColumnIndex),ft=ut;u.sGroupBy!="year"&&(ft=a(ut));et=s(ft);u.asExpandedGroups=[];u.asExpandedGroups.push(et)}o.fnSetColumnVis(u.iGroupingColumnIndex,!u.bHideGroupingColumn);u.bCustomColumnOrdering&&o.fnSetColumnVis(u.iGroupingOrderByColumnIndex,!u.bHideGroupingOrderByColumn);u.iGroupingColumnIndex2!=-1&&o.fnSetColumnVis(u.iGroupingColumnIndex2,!u.bHideGroupingColumn2);u.bCustomColumnOrdering2&&o.fnSetColumnVis(u.iGroupingOrderByColumnIndex2,!u.bHideGroupingOrderByColumn2);o.fnSettings().aoDrawCallback.push({fn:at,sName:"fnRowGrouping"});b=[];b.push([u.iGroupingOrderByColumnIndex,u.sGroupingColumnSortDirection]);u.iGroupingColumnIndex2!=-1&&b.push([u.iGroupingOrderByColumnIndex2,u.sGroupingColumnSortDirection2]);o.fnSettings().aaSortingFixed=b;switch(u.sGroupBy){case"letter":o.fnSettings().aoColumns[u.iGroupingOrderByColumnIndex].sSortDataType="rg-letter";n.fn.dataTableExt.afnSortData["rg-letter"]=function(t,i){var r=[];return n("td:eq("+i+")",t.oApi._fnGetTrNodes(t)).each(function(){r.push(g(this.innerHTML))}),r};break;case"year":o.fnSettings().aoColumns[u.iGroupingOrderByColumnIndex].sSortDataType="rg-date";n.fn.dataTableExt.afnSortData["rg-date"]=function(n,t){var i=[],r=n.oApi._fnGetTrNodes(n);for(l=0;l<r.length;l++)i.push(k(o.fnGetData(r[l],t)));return i}}u.bUseFilteringForGrouping&&n.fn.dataTableExt.afnFiltering.push(lt);o.fnDraw()})}})(jQuery);
//# sourceMappingURL=jquery.dataTables.rowGrouping.min.js.map
