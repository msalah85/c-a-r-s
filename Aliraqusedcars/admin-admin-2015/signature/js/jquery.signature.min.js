(function(n){var t={options:{distance:0,background:"#ffffff",color:"#000000",thickness:2,guideline:!1,guidelineColor:"#a0a0a0",guidelineOffset:50,guidelineIndent:10,notAvailable:"Your browser doesn't support signing",syncField:null,change:null},_create:function(){this.element.addClass(this.widgetFullName||this.widgetBaseClass);try{this.canvas=n('<canvas width="'+this.element.width()+'" height="'+this.element.height()+'">'+this.options.notAvailable+"<\/canvas>")[0];this.element.append(this.canvas);this.ctx=this.canvas.getContext("2d")}catch(t){n(this.canvas).remove();this.resize=!0;this.canvas=document.createElement("canvas");this.canvas.setAttribute("width",this.element.width());this.canvas.setAttribute("height",this.element.height());this.canvas.innerHTML=this.options.notAvailable;this.element.append(this.canvas);G_vmlCanvasManager&&G_vmlCanvasManager.initElement(this.canvas);this.ctx=this.canvas.getContext("2d")}this._refresh(!0);this._mouseInit()},_refresh:function(t){if(this.resize){var i=n(this.canvas);n("div",this.canvas).css({width:i.width(),height:i.height()})}this.ctx.fillStyle=this.options.background;this.ctx.strokeStyle=this.options.color;this.ctx.lineWidth=this.options.thickness;this.ctx.lineCap="round";this.ctx.lineJoin="round";this.clear(t)},clear:function(n){this.ctx.clearRect(0,0,this.element.width(),this.element.height());this.options.guideline&&(this.ctx.save(),this.ctx.strokeStyle=this.options.guidelineColor,this.ctx.lineWidth=1,this.ctx.beginPath(),this.ctx.moveTo(this.options.guidelineIndent,this.element.height()-this.options.guidelineOffset),this.ctx.lineTo(this.element.width()-this.options.guidelineIndent,this.element.height()-this.options.guidelineOffset),this.ctx.stroke(),this.ctx.restore());this.lines=[];n||this._changed()},_changed:function(t){this.options.syncField&&n(this.options.syncField).val(this.toJSON());this._trigger("change",t,{})},_setOptions:function(){this._superApply?this._superApply(arguments):n.Widget.prototype._setOptions.apply(this,arguments);this._refresh()},_mouseCapture:function(){return!this.options.disabled},_mouseStart:function(n){this.offset=this.element.offset();this.offset.left-=document.documentElement.scrollLeft||document.body.scrollLeft;this.offset.top-=document.documentElement.scrollTop||document.body.scrollTop;this.lastPoint=[this._round(n.clientX-this.offset.left),this._round(n.clientY-this.offset.top)];this.curLine=[this.lastPoint];this.lines.push(this.curLine)},_mouseDrag:function(n){var t=[this._round(n.clientX-this.offset.left),this._round(n.clientY-this.offset.top)];this.curLine.push(t);this.ctx.beginPath();this.ctx.moveTo(this.lastPoint[0],this.lastPoint[1]);this.ctx.lineTo(t[0],t[1]);this.ctx.stroke();this.lastPoint=t},_mouseStop:function(n){this.curLine.length===1&&(n.clientY+=this.options.thickness,this._mouseDrag(n));this.lastPoint=null;this.curLine=null;this._changed(n)},_round:function(n){return Math.round(n*100)/100},toJSON:function(){return'{"lines":['+n.map(this.lines,function(t){return"["+n.map(t,function(n){return"["+n+"]"})+"]"})+"]}"},toSVG:function(){return'<?xml version="1.0"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" width="13cm" height="5cm">\n\t<g fill="'+this.options.background+'">\n\t\t<rect x="0" y="0" width="'+this.canvas.width+'" height="'+this.canvas.height+'"/>\n\t\t<g fill="none" stroke="'+this.options.color+'" stroke-width="'+this.options.thickness+'">\n'+n.map(this.lines,function(t){return'\t\t\t<polyline points="'+n.map(t,function(n){return n+""}).join(" ")+'"/>\n'}).join("")+"\t\t<\/g>\n\t<\/g>\n<\/svg>\n"},draw:function(t){this.clear(!0);typeof t=="string"&&(t=n.parseJSON(t));this.lines=t.lines||[];var i=this.ctx;n.each(this.lines,function(){i.beginPath();n.each(this,function(n){i[n===0?"moveTo":"lineTo"](this[0],this[1])});i.stroke()});this._changed()},isEmpty:function(){return this.lines.length===0},_destroy:function(){this.element.removeClass(this.widgetFullName||this.widgetBaseClass);n(this.canvas).remove();this.canvas=this.ctx=this.lines=null;this._mouseDestroy()}};n.Widget.prototype._destroy||n.extend(t,{destroy:function(){this._destroy();n.Widget.prototype.destroy.call(this)}});n.Widget.prototype._getCreateOptions===n.noop&&n.extend(t,{_getCreateOptions:function(){return n.metadata&&n.metadata.get(this.element[0])[this.widgetName]}});n.widget("kbw.signature",n.ui.mouse,t);n.kbw.signature.options=n.kbw.signature.prototype.options})(jQuery);
//# sourceMappingURL=jquery.signature.min.js.map
